(function(){var t,e,i,n,r;r=window.rh,e=r._,t=r.$,i=r.consts,n=r.model,e.getRootUrl=function(){var t;return t=null,function(){return null!=t?t:t=""+e.getHostFolder()+i("START_FILEPATH")}}(),e.runTopicLoadingAnimation=function(){var t,r;return t=null,r=!1,function(o){return r=o,o?(null==t&&(t=e.debounce(function(){return n.publish(i("EVT_TOPIC_LOADING"),r)},700)),t()):(t=null,n.publish(i("EVT_TOPIC_LOADING"),!1))}}(),e.getTopicFrame=function(){var e;return e=window.gTopicFrameName||"rh_default_topic_frame_name",t("[name="+e+"]",0)}}).call(this),function(){var t,e,i,n,r,o,s;s=window.rh,t=s._,s.$,e=s.consts,(n=s.model).publish(e("KEY_SHOW_TAGS"),"true"===s._params.showtags),n.publish(e("KEY_IFRAME_EVENTS"),{click:!0}),r={},i=function(){var i;return i=t.hashParams(),n.publish(e("EVT_HASH_CHANGE"),{oldMap:r,newMap:i},{sync:!0}),r=i},o=function(){var i,n,r,o,s,a;if(s=t.extractParamString(document.location.href),o=t.urlParams(s),n=t.extractHashString(document.location.href),i=t.hashParams(n),r=e("RHMAPNO"),a=e("HASH_KEY_TOPIC"),!(r in o||a in i))return document.location=e("DEFAULT_TOPIC")},t.addEventListener(window,"hashchange",i),t.addEventListener(window,"orientationchange",function(i){var r,o;if(n.publish(e("EVT_ORIENTATION_CHANGE"),null),n.get(e("KEY_SCREEN_IPAD"))&&(o=t.getTopicFrame()))return r=o.style.display,o.style.display="none",o.offsetHeight,t.defer(function(){return o.style.display=r,t.delay(function(){return o.offsetHeight,t.delay(function(){return o.offsetHeight},500)},200)})}),n.subscribe(e("EVT_WIDGET_LOADED"),function(){var r,a,u,l;return n.subscribe(e("KEY_MERGED_FILTER_KEY"),function(){return new s.widgets.ExpressionBuilder}),new s.widgets.BrowseSequenceBuilder,i(),s.layoutPrint=window.print,window.print=function(){return n.publish(e("EVT_PRINT_TOPIC"),null)},t.getFileName(document.location.href)===e("TOPIC_FILE")&&(u=o())?u:(l=t.getTopicFrame())?l.onload=function(){return n.publish(e("EVT_TOPIC_LOADED"),null)}:(a=t.extractParamString(document.location.href),r=t.urlParams(a),e("RHMAPNO")in r?document.location=e("TOPIC_FILE")+"?"+a:void 0)}),n.subscribe(e("EVT_BOOKMARK")+"#content_top_placeholder",function(){return n.publish(e("EVT_SCROLL_TO_TOP"),null)}),n.subscribe(e("KEY_PROJECT_LIST"),function(){return s.filterObject=new s.MergeProj}),n.subscribe(e("EVT_PROJECT_LOADED"),function(){return"deviceready",document.addEventListener("deviceready",function(){if(null!=window.cordova)return n.publish(e("KEY_MOBILE_APP_MODE"),!0)})})}.call(this),function(){var t,e,i,n,r;r=window.rh,n=r.model,e=r._,i=r.consts,t=function(){function t(){this.tagCombs=[],this.idmap={},this.filter=[],this.grpType="group",this.dataLoaded=!1,this.loadTagData(n.get(i("KEY_PROJECT_LIST"))),this.caption=this.type=this.defFilter=void 0}var r,o;return t.prototype.updateTagCombs=function(t){var r,o;if(null!=(o=n.get(i("KEY_PROJECT_TAG_COMBINATIONS"))))return t=e.parseProjectName(t),null!=(r=this.idmap)[t]?r[t]:r[t]=o},t.prototype.lookup=function(t,e,i){var n,r,o,s,a;if(null==i&&(i=!0),null!=t&&null!=e)for(s=0,a=t.length;s<a&&(null==(n=t[s])||(r=n.name||n.display,i===(null!=n.children)&&r===e?o=n:null==n.children||i||(o=this.lookup(n.children,e,i)),null==o));s++);return o},r=function(t){return{type:this.grpType,display:t,children:[]}},t.prototype.addTag=function(t,e){var i;if(null==this.lookup(this.filter,e.name,!1))return i={display:e.display,name:e.name},t.push(i)},t.prototype.addGroup=function(t){var e,i,n,o,s;for(null==(i=this.lookup(this.filter,t.display))&&(i=r(t.display),this.filter.push(i)),n=0,o=(s=t.children).length;n<o;n++)null!=(e=s[n])&&null==e.children&&this.addTag(i.children,e);if(0===i.children.length&&this.filter.indexOf(i)>-1)return this.filter.splice(this.filter.indexOf(i),1)},t.prototype.updateFilter=function(){var t,e,r,o,s;for(t=n.get(i("KEY_TEMP_DATA"))||[],this.caption||(this.caption=t.caption),this.type||(this.type=t.type),void 0===this.defFilter&&(this.defFilter=t.default),t=t.tags||[],n.publish(i("KEY_TEMP_DATA")),s=[],r=0,o=t.length;r<o;r++)null!=(e=t[r])&&(null!=e.children?s.push(this.addGroup(e)):s.push(this.addTag(this.filter,e)));return s},o=function(t,e){if(this.updateTagCombs(t),this.updateFilter(),!e)return n.publish(i("KEY_MERGED_FILTER_KEY"),this.filter),n.publish(i("KEY_MERGED_PROJECT_MAP"),this.idmap),n.publish(i("KEY_PROJECT_FILTER_CAPTION"),this.caption),n.publish(i("KEY_PROJECT_FILTER_TYPE"),this.type),n.publish(i("KEY_DEFAULT_FILTER"),this.defFilter),this.dataLoaded=!0},t.prototype.loadTagData=function(t){var n,r,s,a,u;if(!this.dataLoaded){for(n=t.length,u=[],r=0,s=t.length;r<s;r++)null!=(a=t[r])?(a&&(a+="/"),u.push(e.loadScript(""+a+i("PATH_PROJECT_TAGDATA_FILE"),!1,o.bind(this,a,--n)))):u.push(void 0);return u}},t}(),r.MergeProj=t}.call(this),function(){var t,e,i,n,r,o,s=function(t,e){return function(){return t.apply(e,arguments)}};n=window.rh,e=n._,n.$,i=n.consts,r=n.storage,o=n._params.filter,t=function(){function t(t){this.handleTagStates=s(this.handleTagStates,this),this.getUnchecked=s(this.getUnchecked,this),r.init(i("HELP_ID")),this.allTagNames=this.computeNames(n.model.get(i("KEY_MERGED_FILTER_KEY"))),this.prepareTagStates(),this.handleTagStates(n.model.get(i("KEY_PROJECT_TAG_STATES"))),n.model.subscribe(i("KEY_PROJECT_TAG_STATES"),e.debounce(this.handleTagStates,300),{initDone:!0})}return":",";",",",t.prototype.computeNames=function(t){return e.reduce(t,function(t,e){return t.push(e.children?this.computeNames(e.children):e.name),t},[],this)},t.prototype.getUnchecked=function(t,i){return e.filter(this.allTagNames[t],function(t){return-1===i.indexOf(t)})},t.prototype.computeExpression=function(t){var r;return t&&this.allTagNames?(r=e.reduce(t,function(t,i,n){var r;return e.isString(i)?t.push({c:[i],u:[]}):null!=i&&(r=e.compact(i))&&r.length>0&&t.push({c:r,u:this.getUnchecked(n,r)}),t},[],this),n.model.publish(i("KEY_TAG_EXPRESSION"),r)):n.model.publish(i("KEY_TAG_EXPRESSION"),[])},t.prototype.handleTagStates=function(t){return null==t&&(t={}),this.computeExpression(t),r.persist("tag_states",t)},t.prototype.prepareTagStates=function(){return n.model.subscribe(i("KEY_PROJECT_FILTER_TYPE"),function(t){return function(){var s,a;if(o&&(s=n.model.get(i("KEY_MERGED_FILTER_KEY")),a=t.parseUrlFilter(s,o.split(","))),a||(a=r.fetch("tag_states")),a||(a=e.clone(n.model.get(i("KEY_DEFAULT_FILTER")))),o&&(e.isEmptyObject(a)||e.isEmptyObject(a[0])?(a=e.clone(n.model.get(i("KEY_DEFAULT_FILTER"))),window.loadTopic(n.consts("LANGUAGE_DIR")+n.consts("ERROR_TOPIC"))):-1===document.location.href.indexOf("#t")&&e.isEmptyString(getUrlParameter(RHMAPID))&&window.loadTopic(n.consts("LANGUAGE_DIR")+Object.values(a[0])[0].replace("_","-")+".htm")),a)return n.model.publish(i("KEY_PROJECT_TAG_STATES"),a)}}(this))},t.prototype.parseFilterElemnt=function(t,i){var n,r,o,s;return s=i.split(":"),o=s[0],n=s[1]&&s[1].split(";"),r=e.findIndex(t,function(t){return null!=n==(null!=t.children)&&t.display===o}),{index:r,elements:n}},t.prototype.parseUrlFilter=function(t,r){var o,s;if(r||r.length)return s="radio"===n.model.get(i("KEY_PROJECT_FILTER_TYPE")),o=!0,e.reduce(r,function(e,i,n){var r,a,u;return u=this.parseFilterElemnt(t,i),n=u.index,r=u.elements,-1!==n&&((a=t[n]).children?e[n]=this.parseUrlFilter(a.children,r):s&&!o||(o=!1,e[n]=a.name)),e},{},this)},t}(),n.widgets.ExpressionBuilder=t}.call(this),function(){var t,e,i;i=window.rh,e=i._,i.$,t=function(){return function(){var t,n;t=function(t){var n,r,o,s;if(null!=(n=i.model.get("t.brsmap")))return o=n.n&&n.n[0]||"",s=n.p&&n.p[0]||"",r=window.decodeURI(document.location.href),e.isEmptyString(o)||(o=window._getRelativeFileName(r,o)),e.isEmptyString||(s=window._getRelativeFileName(r,s)),i.model.publish("l.brsBack",s),i.model.publish("l.brsNext",o)},n=function(){var t,e,n,r;return r=i.model.get(i.consts("KEY_UI_MODE")),e=i.model.get("l.brsBack"),t=i.model.get("l.brsNext"),n=!(r||!e&&!t),i.model.publish("l.show_brs",n)},i.model.subscribe("t.topicurl",e.debounce(t,200)),i.model.subscribe("t.brsmap",e.debounce(t,200)),i.model.subscribe("l.brsBack",n),i.model.subscribe("l.brsNext",n),i.model.subscribe(i.consts("KEY_UI_MODE"),n)}}(),i.widgets.BrowseSequenceBuilder=t}.call(this),function(){var t,e,i,n,r,o;n=window.rh,t=n._,n.$,e=n.consts,i=n.model,r=n.rhs,o=null,o=i.subscribe(e("KEY_TAG_EXPRESSION"),function(){var t;return t=!1,function(){if(o&&o(),!t)return t=!0,i.subscribe(e("KEY_SEARCHED_TERM"),function(){return i.publish(e("KEY_ONSEARCH_TAG_EXPR"),JSON.stringify(i.get(e("KEY_TAG_EXPRESSION"))))})}}()),i.subscribe(e("EVT_SEARCH_TERM"),function(){var n,r,o;return n=i.get(e("KEY_CAN_HANDLE_SEARCH")),o=i.get(e("KEY_SEARCH_TERM"))||null,r={},r[e("HASH_KEY_RH_SEARCH")]=o,r[e("HASH_KEY_UIMODE")]="search",!0!==n?document.location=window.gRootRelPath+"/"+(window.gSearchPageFilePath||e("START_FILEPATH"))+"?#"+t.mapToEncodedString(r):(i.publish(e("EVT_QUERY_SEARCH_RESULTS"),!0),t.defer(function(){return t.updateHashMap(r,!0)}))}),i.subscribe(e("EVT_PROJECT_LOADED"),function(){return window.readSetting&&window.readSetting(RHANDSEARCH,function(t){return i.publish(e("KEY_AND_SEARCH"),t)}),i.subscribe(e("KEY_AND_SEARCH"),function(t){return saveSetting(RHANDSEARCH,"1"===t?"1":"0",!0)})}),i.subscribe(e("EVT_QUERY_SEARCH_RESULTS"),function(){if(!r.doSearch())return window.doSearch()})}.call(this),function(){var t,e,i;(i=window.rh)._,t=i.$,e=i.consts,i.model.subscribe(e("EVT_WIDGET_BEFORELOAD"),function(){var e;if(null!==t("a.wShow",0))return e=t(".contenttopic",0),t.setAttribute(e,"data-rhwidget","Basic"),t.setAttribute(e,"data-class","govt_csh:@.l.csh_mode;govt_nocsh:!@.l.csh_mode")})}.call(this),function(){var t,e,i,n,r,o=function(t,e){return function(){return t.apply(e,arguments)}};r=window.rh,i=r._,t=r.$,n=r.consts,e=function(){function e(t){this.widget=t,this.click=o(this.click,this)}var r;return"group","item",r=n("KEY_PROJECT_FILTER_TYPE"),e.prototype.click=function(t){var e,r,o,s,a;return a=t.currentTarget,e=t.target,r=this.getItemNode(e,a),s=""+n("KEY_PROJECT_TAG_STATES")+this.getItemKey(r),o=this.widget.get(s),"radio"!==this.filterType()?this.handleCheckboxClick(r,s,o):this.handleRadioClick(r,s,o),i.preventDefault(t)},e.prototype.handleRadioClick=function(t,e,n){var r,o,s,a;if(!this.isGroupNode(t)&&!n)return a=i.splitKey(e),s=a.parentKey,r=a.key,o={},o[r]=this.getItemValue(t),this.widget.publish(s,o)},e.prototype.handleCheckboxClick=function(t,e,n){var r,o;return this.isGroupNode(t)?(r=i.any(n,function(t){return t}),o=r?void 0:this.getGroupItemExprs(t),this.widget.publish(e,o)):(o=n?void 0:this.getItemValue(t),this.widget.publish(e,o))},e.prototype.getItemNode=function(e,n){return i.findParentNode(e,n,function(e){return"LI"===t.nodeName(e)})},e.prototype.getItemValue=function(e){return t.dataset(e,"itemvalue")},e.prototype.getGroupItemExprs=function(e){var n,r;return r=t.dataset(e,"itemkey"),n=this.widget.get(""+this.widget.key+r),i.map(n.children,function(t){return t.name})},e.prototype.getItemKey=function(e){return t.dataset(e,"itemkey")},e.prototype.isGroupNode=function(e){return t.hasClass(e,"group")},e.prototype.isItemNode=function(e){return t.hasClass(e,"item")},e.prototype.class=function(t){return t.children?"group":"item"},e.prototype.value=function(t){return t.children?null:t.name},e.prototype.filterType=function(){return this.widget.get(r)||"checkbox"},e.prototype.inputType=function(t){var e;return e=this.filterType(),t.children&&"radio"===e&&(e=void 0),e},e}(),r.controller("FilterController",e)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){function t(t){this.widget=t,this.triggerDelayLoadWidgets=e(this.triggerDelayLoadWidgets,this),this.init(),this.subscribeActiveTab(),this.subscribeToLocations(),this.subscribeScreens(),this.widget.subscribe(h("EVT_PROJECT_LOADED"),function(t){return function(){return t.subscribeUIMode(),t.subscribeMergedFilter(),t.subscribeTopicClick(),t.subscribeTopicScroll(),t.subscribForSearchResult(),t.subscribeTopicNavigate(),t.subscribeToDelayLoadEvents(),t.widget.publish(h("KEY_IFRAME_EVENTS"),{click:!0,scroll:!1})}}(this))}var i,n,r,o,s,a,u,l,c,h,d,_,p,f;return _=window.rh,c=_._,_.$,h=_.consts,n=h("KEY_FEATURE"),r=h("KEY_FILTER_LOCATION"),s=h("KEY_SEARCH_LOCATION"),i=h("KEY_ACTIVE_TAB"),u=h("KEY_UI_MODE"),o=h("KEY_MOBILE_TOC_DRILL_DOWN"),a=h("KEY_TOC_DRILL_DOWN"),"desktop","tablet","phone",l="filter"!==_._params.hideUI,f={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo","filter","fts"]},p={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo"]},d={idx:{evt:"EVT_LOAD_IDX",f_key:"delay_load_idx"},glo:{evt:"EVT_LOAD_GLO",f_key:"delay_load_glo"}},t.prototype.init=function(){return this.screens=this.widget.get(h("KEY_SCREEN_NAMES")),_.storage.init(h("HELP_ID")),this.activeScreen=c.find(this.screens,function(t){return this.widget.get(h("KEY_SCREEN")+"."+t+".attached")},this),null==this.activeScreen&&(this.activeScreen=this.widget.get(h("KEY_DEFAULT_SCREEN"))),this.assureLocations(this.activeScreen),this.initDefauls(),this.initActiveTab()},t.prototype.initDefauls=function(){var t;return t=this.widget.get(h("KEY_DEFAULT_TAB")),this.hasFeature(t)||(t=null),this.defaultTabs={},c.each(this.screens,function(e){return f[e]=c.filter(f[e],function(t){return this.hasFeature(t)},this),p[e]=c.filter(p[e],function(t){return this.hasFeature(t)},this),this.defaultTabs[e]=t&&-1!==f[e].indexOf(t)?t:f[e][0]},this)},t.prototype.initActiveTab=function(){var t;if(void 0!==(t=_.storage.fetch("activetab"))&&t&&this.hasFeature(t))return this.widget.publish(i,t)},t.prototype.isValidTab=function(t,e){return null==e&&(e=this.activeScreen),!(!t||!this.hasFeature(t))&&(("desktop"!==e||!("filter"===t&&"content"===this.widget.get(r)||"fts"===t&&"content"===this.widget.get(s)))&&-1!==f[e].indexOf(t))},t.prototype.defaultTab=function(t){var e;return null==t&&(t=this.activeScreen),e=this.defaultTabs[t],this.isValidTab(e)||(e=c.find(f[t],function(t){return this.isValidTab(t)},this)),e},t.prototype.assureValidActiveTab=function(t){var e;if(null==t&&(t=this.activeScreen),e=this.widget.get(i),"desktop"===t||e)return this.isValidTab(e)||(e=this.defaultTab()),this.widget.publish(i,e)},t.prototype.toggleSideBar=function(){return this.widget.get(i)?this.widget.publish(i,null):this.widget.publish(i,this.lastMobileTab||this.defaultTab())},t.prototype.toggleActiveTab=function(t){return this.widget.publish(i,this.isDesktopScreen()||t!==this.widget.get(i)?t:null)},t.prototype.triggerDelayLoadWidgets=function(t){var e;if((e=d[t])&&this.hasFeature(e.f_key))return this.widget.publish(h(e.evt),!0)},t.prototype.subscribeToDelayLoadEvents=function(){return this.widget.subscribe(i,this.triggerDelayLoadWidgets)},t.prototype.filterDone=function(){return this.widget.publish(i,this.searchMode?"fts":null)},t.prototype.hasFeature=function(t){return void 0===t||!1!==this.widget.get(n+"."+t)},t.prototype.subscribeUIMode=function(){var t;if(t=function(t){return function(){if(t.isValidTab("fts"))return t.isDesktopScreen()&&"tabbar"!==t.widget.get(s)?void 0:t.widget.publish(i,"fts")}}(this),this.widget.subscribe(u,function(t){return function(e){return t.widget.publish("active_content",e)}}(this)),this.widget.subscribe("active_content",function(e){return function(n){return e.isMobileScreen()&&!n?e.widget.publish(i,null):"search"===n?t():void 0}}(this),{initDone:!0}),"search"===this.widget.get("active_content"))return t()},t.prototype.subscribeMergedFilter=function(){var t;if(this.widget.get(t=n+".filter"))return this.widget.subscribe(h("KEY_MERGED_FILTER_KEY"),function(e){return function(i){return e.widget.publish(t,!!(i&&i.length&&l)),e.assureValidActiveTab()}}(this))},t.prototype.subscribeTopicClick=function(){return this.widget.subscribe(h("EVT_CLICK_INSIDE_IFRAME"),function(t){return function(){if("phone"===t.activeScreen&&t.widget.get(i))return t.toggleSideBar()}}(this))},t.prototype.subscribeTopicNavigate=function(){return this.widget.subscribe(h("EVT_NAVIGATE_TO_URL"),function(t){return function(e){if(e.absUrl&&c.isUrlAllowdInIframe(e.absUrl))return t.widget.publish("active_content",null)}}(this))},t.prototype.subscribeTopicScroll=function(){return this.widget.subscribe(h("EVT_SCROLL_INSIDE_IFRAME"),function(t){return function(e){var i,n;return i="down"===e.dir||e.scrollTop>10,t.widget.publish("hide_header",i),n="down"===e.dir&&e.scrollTop>10,t.widget.publish("hide_mobile_functions",n)}}(this))},t.prototype.subscribeActiveTab=function(){return this.widget.subscribe(i,function(t){return function(e){return _.storage.persist("activetab",e),t.isMobileScreen()?(t.isSidebarTab(e)&&(t.lastMobileTab=e),t.searchMode="fts"===e||t.searchMode&&"filter"===e):t.searchMode=!1}}(this))},t.prototype.subscribeScreens=function(){return c.each(this.screens,function(t){var e;return e=h("KEY_SCREEN")+"."+t+".attached",this.widget.get(e)&&this.handleScreen(!0,t),this.widget.subscribe(e,function(e){return function(i){return e.handleScreen(i,t)}}(this),{initDone:!0})},this)},t.prototype.subscribeToLocations=function(){return this.widget.subscribe(s,function(t){return function(){return t.assureValidActiveTab(t.activeScreen)}}(this)),this.widget.subscribe(r,function(t){return function(){return t.assureValidActiveTab(t.activeScreen)}}(this))},t.prototype.subscribForSearchResult=function(){var t;return t=function(t){return function(){var e,i;if(i=t.widget.get(h("KEY_TAG_EXPRESSION")),(e=t.widget.get(h("KEY_ONSEARCH_TAG_EXPR")))&&e!==JSON.stringify(i))return t.widget.publish(h("EVT_SEARCH_TERM"),!0)}}(this),this.widget.subscribe(h("KEY_TAG_EXPRESSION"),c.debounce(function(e){return function(){if((!e.isValidTab("fts")||"fts"===e.widget.get(i))&&e.isSearchMode(e.widget.get(i)))return t()}}(this),300)),this.widget.subscribe(i,function(e){if("fts"===e)return t()})},t.prototype.isMobileScreen=function(){return"phone"===this.activeScreen},t.prototype.isDesktopScreen=function(){return"desktop"===this.activeScreen},t.prototype.isTabletScreen=function(){return"tablet"===this.activeScreen},t.prototype.isSidebarTab=function(t){return t&&-1!==p[this.activeScreen].indexOf(t)},t.prototype.isSearchMode=function(t){var e;return e=this.widget.get("active_content"),"fts"===t||"search"===e&&this.isDesktopScreen()&&"content"===this.widget.get(s)},t.prototype.handleScreen=function(t,e){return t?(this.activeScreen=e,this.handleAttached(e)):this.handleDetached(e)},t.prototype.handleDetached=function(t){return c.defer(function(e){return function(){if("desktop"===t)return e.widget.publish(i,"search"===e.widget.get("active_content")&&e.isValidTab("fts")?"fts":null)}}(this))},t.prototype.handleAttached=function(t){return this.assureLocations(t),this.assureValidActiveTab(t),this.assureTOCMode(t)},t.prototype.assureLocations=function(t){return null==t&&(t=this.activeScreen),this.widget.publish(s,"desktop"===t?this.widget.get(h("KEY_DEFAULT_SEARCH_LOCATION")):"tablet"===t?"tabbar":"content"),this.widget.publish(r,"desktop"===t||"tablet"===t?"tabbar":"content")},t.prototype.assureTOCMode=function(t){return null==t&&(t=this.activeScreen),this.widget.publish(a,"desktop"!==t&&this.widget.get(o))},t.prototype.newSearch=function(t,e,i){if(13===e&&(this.widget.get(h("KEY_SEARCH_TERM"))!==t&&this.widget.publish(h("KEY_SEARCH_TERM"),t),this.widget.publish(h("EVT_SEARCH_TERM"),!0),null!=i?i.target:void 0))return i.target.blur()},t.prototype.isTagStatesChanged=function(){var t,e;return t=c.compactObject(this.widget.get(h("KEY_PROJECT_TAG_STATES"))),e=c.compactObject(this.widget.get(h("KEY_DEFAULT_FILTER"))),!c.isEqual(t,e)},t.prototype.setDefaultTagStates=function(){var t;return t=this.widget.get(h("KEY_DEFAULT_FILTER")),this.widget.publish(h("KEY_PROJECT_TAG_STATES"),c.clone(t))},t}(),window.rh.controller("ModernLayoutController",t)}.call(this),function(){var t;t=function(){var t,e,i;return i=window.rh,t=i.$,e=i._,function(i,n){var r;r=(null!=n?n.removeClasses:void 0)||["hide-children","loading"],e.each(r,function(e){return t.removeClass(i.node,e)}),e.each(null!=n?n.addClasses:void 0,function(e){return t.addClass(i.node,e)})}}(),window.rh.controller("JsLoadingController",t)}.call(this),function(){var t,e,i,n,r;r=window.rh,e=r._,n=r.model,i=r.consts,t=function(){var t,r,o,s,a;return s=[],a=[],"projectdata.js","remote","project","url",o=0,r=function(r){var u;return u=r+"/projectdata.js",window.xmlJsReader.loadFile(u,function(r,u){var l;if(0,o++,null!=r&&(l=r.getElementsByTagName("project")[0].getElementsByTagName("remote")).length,e.each(l,function(t){var e;return e=u+"/"+t.getAttribute("url"),s.push(e),a.push(e)}),t(),0===a.length&&o===s.length)return n.publish(i("KEY_PROJECT_LIST"),s),n.publish(i("KEY_MASTER_PROJECT_LIST"),["."])},r)},t=function(){var t,e;for(e=[];a.length>0;)t=a.splice(0,1),e.push(r(t));return e},function(){s.push("."),a.push("."),t()}}(),n.subscribe(i("EVT_PROJECT_LOADED"),function(){return e.defer(function(){if(!n.get(i("KEY_PUBLISH_MODE"))&&!window.gbPreviewMode)return new t})})}.call(this),function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return r(i||t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(i,n,r){var o=t.rh,s=o._,a=(o.$,o.consts),u=o.model,l=a("HASH_KEY_RH_SEARCH"),c=a("HASH_KEY_TOPIC"),h=a("HASH_KEY_UIMODE"),d=a("HASH_KEY_RH_TOCID"),_=a("HASH_KEY_RH_HIGHLIGHT"),p=a("HASH_KEY_RANDOM"),f=[_,a("HASH_KEY_RH_SYNS"),d],v=s.queueUpdateHashMap,g=function(t){return null==t&&(t={}),t[h]=null,t[p]=null,t[d]||(t[d]=null),t[_]||(t[_]=null),t},E=function(t,e){t=s.fixRelativeUrl(t);var i=s.urlParams(s.extractParamString(t));return i[c]=s.stripParam(t),i=g(i),v(i,e)},y=function(e){var i=void 0,n=e.newMap,r=e.oldMap,v=r[h],g=n[h];if(l in n){var E=n[l];i=E!==u.get(a("KEY_SEARCHED_TERM")),u.publish(a("KEY_SEARCH_TERM"),E,{sync:!0})}if("search"===g&&i&&t.gHost&&u.publish(a("EVT_QUERY_SEARCH_RESULTS"),!0),!g||n[c]){var y=void 0,m=u.get(a("KEY_TOPIC_IN_IFRAME"));c in n&&(y=n[c]),y||(y=m);var b=o.model.get(o.consts("KEY_FEATURE"));y||b&&!1===b.showDefTopic||(y=null!=t.gDefaultTopic?t.gDefaultTopic.substring(1):void 0);y&&(y!==m||v!==g||r[_]!==n[_]||r[d]!==n[d])&&(s.stripBookmark(y)!==s.stripBookmark(m)&&s.runTopicLoadingAnimation(!0),u.publish(a("KEY_TOPIC_IN_IFRAME"),y),t.loadTopic(function(t,e){e=e;var i=s.filePath(e),n=s.extractHashString(e);n.length>0&&(n="#"+n);var r=s.urlParams(s.extractParamString(e)),o=!0,l=!1,c=void 0;try{for(var h,d=Array.from(f)[Symbol.iterator]();!(o=(h=d.next()).done);o=!0){var _=h.value;null!=t[_]&&(r[_]=t[_])}}catch(t){l=!0,c=t}finally{try{!o&&d.return&&d.return()}finally{if(l)throw c}}u.get(a("KEY_SCREEN_IOS"))&&(r[p]=s.uniqueId());var v=s.mapToEncodedString(r);return v.length>0&&(v="?"+v),""+i+v+n}(n,y)))}return u.publish(a("KEY_UI_MODE"),n[h])},m=function(i){var n=s.hashParams();if(i&&!n[h]){var r=decodeURI(e.location.href),o=t._getRelativeFileName(r,i),l=n[c];if(!l||s.filePath(o)!==s.filePath(l))return u.publish(a("KEY_TOPIC_IN_IFRAME"),o),E(o,!1)}},b=function(t){var i=t.absUrl;if(!s.isRootUrl()){if(!s.isRootUrl(i)){var n=void 0,r=void 0,o=s.getRootUrl();s.isExternalUrl(i)?r=i:(n=s.getParamsForRoot(i),r=s.fixRelativeUrl(s.makeRelativePath(i,o))),i=""+o+n+"#t="+encodeURIComponent(r)}return e.location.href=i}if(!s.isUrlAllowdInIframe(i))return function(t,e){var i={};return i[c]=t,i=g(i),v(i,e)}(i,!0);if(i=s.makeRelativeUrl(s.fixRelativeUrl(i)),s.isHomeUrl(i))return e.location.href=i;var u=i&&s.filePath(i);if(u===a("START_FILEPATH")?i=i.substring(u.length):i||(i="#ux"),"#"===i[0]||"?"===i[0]){var l=s.hashParams(s.extractHashString(i));return h in l||(l[h]=null),v(l,!0)}return i?E(i,!0):void 0};u.subscribe(a("EVT_WIDGET_LOADED"),function(){return s.addEventListener(e,"click",s.hookClick),u.subscribe(a("EVT_HASH_CHANGE"),y),u.subscribe(a("KEY_TOPIC_URL"),m),u.subscribe(a("EVT_NAVIGATE_TO_URL"),b),u.subscribe(a("KEY_TOPIC_IN_IFRAME"),function(i){if(""+t.gHost+t.gHostPath!="/"&&(t.setTopic&&t.setTopic(),t.changeTopicLink))return t.changeTopicLink(e.location.toString())}),u.subscribe(a("EVT_TOPIC_LOADED"),function(){return s.runTopicLoadingAnimation(!1)}),u.subscribe(a("EVT_INSIDE_IFRAME_DOM_CONTENTLOADED"),function(){return s.runTopicLoadingAnimation(!1)})})},{}],2:[function(e,i,n){var u=t.rh,l=u.model,c=u._,h=u.consts,d=(u.http,function(){var t=void 0;return(d=function(e){function i(t){r(this,i);var e=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.data=[],e.chunkCount=0,e.count=0,e.keys="",e.alhpabet="",e.loadNavData("glo"),e.filter="",e.widget=t,e.widget.publish("show",{}),e}return s(i,u.NavController),a(i,null,[{key:"initClass",value:function(){t="entrys"}}]),a(i,[{key:"addElement",value:function(e,i){var n=this;return function(){var r=[];return c.each(e[t],function(t){null!=t&&(n.lookup(i,t)?r.push(void 0):r.push(i.push(t)))},n),r}()}},{key:"exists",value:function(t){var e=this.alphaText(t);return this.alhpabet.indexOf(e)>-1||(this.alhpabet+=e,!1)}},{key:"isFiltered",value:function(t,e){var i=e?l.get(e):this.filter;return i&&-1===t.toLocaleLowerCase().indexOf(i.toLocaleLowerCase())}},{key:"alphaText",value:function(t){return t.toUpperCase().charAt(0)}},{key:"filterGlo",value:function(t){return this.filter=t.toLocaleLowerCase(),this.alhpabet="",l.publish(h("PROJECT_GLOSSARY_DATA"),l.get(h("PROJECT_GLOSSARY_DATA")))}}]),i}()).initClass(),d}());u.controller("GlossaryController",d)},{}],3:[function(i,u,l){var c=t.rh,h=c.model,d=c._,_=c.consts,p=c.http,f=c.rhs,v=function(){function e(){r(this,e),this.updateData=this.updateData.bind(this)}return a(e,[{key:"lookup",value:function(t,e){var i=void 0;return null!=t&&null!=e&&d.any(t,function(t){if(null!=t)return e.type===t.type&&e.name===t.name&&d.isEqual(e.url,t.url)&&(i=t),null!=i},this),i}},{key:"sort",value:function(e){return e.sort(function(e,i){return t.compare(e.name,i.name)})}},{key:"updateData",value:function(t,e){var i=h.get(_("KEY_TEMP_DATA"))||[];if(h.publish(_("KEY_TEMP_DATA")),this.addElement(i,this.data,e,this.keys),0==--this.chunkCount&&0===this.count)return this.sort(this.data),h.publish(_(t),this.data)}},{key:"getChunkData",value:function(t,e){this.count--;var i=function(t,e){return void 0!==t&&null!==t?e(t):void 0}(h.get(_("KEY_TEMP_DATA")),function(t){return t.chunkinfos})||[];return this.chunkCount+=i.length,d.each(i,function(i){var n=this;return t&&(t=d.ensureSlash(t)),d.loadScript(t+"whxdata/"+i.node+".new.js",!1,function(){return n.updateData(e,t)})},this)}},{key:"loadNavData",value:function(t){var e=this;return h.subscribe(_("KEY_PROJECT_LIST"),function(i){return e.alhpabet="",e.count+=i.length,d.each(i,function(e){var i=this;return e&&(e=d.ensureSlash(e)),d.loadScript(e+"whxdata/"+("ndx"===t?"idx":"glo")+".new.js",!1,function(){return i.getChunkData(e,"ndx"===t?"PROJECT_INDEX_DATA":"PROJECT_GLOSSARY_DATA")})},e)})}}]),e}();c.NavController=v;var g=function(){var t=void 0;return(g=function(i){function u(t){r(this,u);var e=o(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));return e.data=[],e.chunkCount=0,e.count=0,e.alhpabet="",e.filter="",e.keys="keys",e.widget=t,h.subscribeOnce(_("EVT_PROJECT_LOADED"),function(){return e.loadNavData("ndx"),e.getIndexData(),h.subscribe(_("KEY_INDEX_FILTER"),function(){return e.alhpabet=""})}),e}return s(u,c.NavController),a(u,null,[{key:"initClass",value:function(){t=""}}]),a(u,[{key:"addElement",value:function(e,i,n,r){var o=this;if(null!=e[r])return function(){var s=[];return d.each(e[r],function(e){if(null!=e){var r;if(!(r=o.lookup(i,e))){var a={type:e.type,name:e.name};e["data-rhtags"]&&(a["data-rhtags"]=e["data-rhtags"]+"+"+n),e.url||(a.topics=[]);var u=d.makeRelativeUrl(""+n,t);null!=e.url&&(a.url=""+encodeURI(u)+e.url),null==e.url&&(a[o.keys]=[]),i.push(a),r=i[i.length-1]}o.addElement(e,r[o.keys],n,o.keys),s.push(o.addElement(e,r.topics,n,"topics"))}},o),s}()}},{key:"showItem",value:function(t){var e=h.get(_("KEY_INDEX_FILTER"));return!e||-1!==t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())}},{key:"showCategory",value:function(t,e){if(e>0)return!1;var i=this.alphaText(t);return!(this.alhpabet.indexOf(i)>-1)&&(this.alhpabet+=i,!0)}},{key:"showNextLevel",value:function(t){for(var e=t.getAttribute("data-indexid"),i=n({},e,!this.widget.get("show."+e));e;)i[e=e.substr(0,e.lastIndexOf("_"))]=!0;return this.widget.publish("show",i)}},{key:"alphaText",value:function(t){return t.toUpperCase().charAt(0)}},{key:"getIndexData",value:function(){return h.subscribeOnce(_("KEY_PUBLISH_BASE_URL"),function(){try{var t=h.get(_("KEY_PUBLISH_BASE_URL")),i=e.location.origin,n=t.substr(i.length);d.parentPath(d.filePath(d.getRootUrl()));if(n&&!d.isEmptyString(n)){var r=d.mapToEncodedString(d.extend(d.addPathNameKey({area:f.area(),prj:f.project(),type:f.type(),agt:"ndx",mgr:"agm"})));return p.get(n+"?"+r).success(function(t,e){var i=[],n=[],r=(t=JSON.parse(t)).allProjects,o=t.masterProjects;r.length&&(r[0]=d.ensureSlash(r[0]));var s=function(t,e){return d.each(t,function(t){return e.push(d.makeRelativeUrl(t,r[0]))})};s(r,i),s(o,n);var a=function(t,e,i){d.isEmptyString(t)&&(i[e]=".")};return d.each(i,a),d.each(n,a),h.publish(_("KEY_PROJECT_LIST"),i),h.publish(_("KEY_MASTER_PROJECT_LIST"),n)})}}catch(t){if(c._debug)return c._d("warn",t.message)}})}}]),u}()).initClass(),g}();c.controller("IndexController",g)},{}],4:[function(t,e,i){t("../../src/lib/rh")._.findEditDist=function(t,e){if(t==e)return 0;for(var i=[],n=[],r=0;r<e.length+1;r++)i.push(r),n.push(0);for(r=0;r<t.length;r++){n[0]=r+1;for(s=0;s<e.length;s++){var o=void 0;o=t[r]==e[s]?0:1,n[s+1]=Math.min(n[s]+1,i[s+1]+1,i[s]+o)}for(var s=0;s<i.length;s++)i[s]=n[s]}return n[n.length-1]}},{"../../src/lib/rh":8}],5:[function(t,e,i){var n=function(t,e){return function(){return t.apply(e,arguments)}},o=t("../../src/lib/rh"),s=t("../../src/responsive_help/utils/node_utils"),u=o._,l=o.$,c=o.model,h=o.consts,d=h("KEY_TOC_DRILL_DOWN"),_=void 0,p=void 0;_=function(){function t(){r(this,t)}return a(t,[{key:"sync",value:function(t,e){var i=void 0;return t.updateActiveBookInfo(0,"_"),i=t.widget.node,this.reset(e),this.syncToProjectToc(t,i.children,function(e){return function(i){return e.syncToTocItem(t,i)}}(this))}},{key:"reset",value:function(t){var e=void 0;return this.parseTocInfo(t),e=this.order.lastIndexOf("@"),this.parentOrder=-1!==e?this.order.substring(0,e):""}},{key:"parseTocInfo",value:function(t){var e=void 0;return this.order=t.childOrder||"",e=u.splitAndTrim(t.childPrefix,"."),this.tocPath=u.reduce(e,function(t,e){var i=void 0,n=void 0;return i=u.splitAndTrim(e,"@"),(n=i.shift())&&t.push({bookNo:u.parseInt(n,0),order:i.length>0?"@"+i.join("@"):""}),t},[]),e=u.splitAndTrim(t.topicID||"0","_"),this.bookNos=u.map(e.shift().split("."),function(t){return u.parseInt(t,0)}),this.pageNo=u.parseInt(e.shift(),0)}},{key:"syncToProjectToc",value:function(t,e,i){var n=void 0,r=void 0,o=void 0;if(this.tocPath.length>0){if(n=0,o=this.tocPath.shift(),-1!==(r=u.findIndex(e,function(e){return!((l.dataset(e,"childorder")||"")!==o.order||!t.isBookNode(e)||++n!==o.bookNo)})))return t.openBook(e[r],!0,function(n){return function(){return u.defer(function(){var o=void 0,s=void 0;if(o=e[r+1],s=o.children&&o.children[0])return n.syncToProjectToc(t,s.children,i)})}}(this))}else if(i)return i(e)}},{key:"syncToTocItem",value:function(t,e,i){var n=void 0,r=void 0,s=void 0;return null==i&&(i=1),r=0,n=0,s=null,u.any(e,function(e){return function(a){var d=void 0,_=void 0,p=void 0;if((l.dataset(a,"childorder")||"")===e.order&&(t.isBookNode(a)&&(s=d=a),d&&n++,e.bookNos[0]===n)){if(t.isPageNode(a)&&(_=a),_&&r++,1===e.bookNos.length)0===e.pageNo?(p=a,s&&t.openBook(s,!0,function(){return t.updateBookInfo()})):_&&r===e.pageNo&&(p=a),t.updateBookInfo(),p&&(t.selectLink(p,!0,i),l.hasClass(p,"rh-hide")&&!o._params.filter&&c.publish(h("EVT_TOPIC_HIDDEN"),!0));else if(s&&l.hasClass(a,"child"))return e.bookNos.shift(),t.openBook(s,!0,function(){return u.defer(function(){var i=void 0;if(i=a.children&&a.children[0])return e.syncToTocItem(t,i.children,700)})}),!0;return null!=p}}}(this))}}]),t}(),p=function(){var t=void 0,e=void 0,i=void 0;t="bookid",e="level",i=".p.toc";var p="curtoc",f=h("KEY_TOC_BREADCRUMBS"),v=function(){function v(s){var a=this;r(this,v),this.widget=s,this.subscribeTopicID=n(this.subscribeTopicID,this),this.onClick=n(this.onClick,this),this.updateBookInfo=n(this.updateBookInfo,this),this._data={},this.projectAbsRef=[],null==this.syncToc&&(this.syncToc=new _),this.widget.publish(e,0),this.widget.publish(t,"_"),o.model.subscribe(i,function(t){a.widget.publish(p,t),a.widget.publish("curlevel",0)}),this.widget.subscribe(h("KEY_TOC_SELECT_ITEM"),this.selectTocItem.bind(this)),c.subscribeOnce([h("EVT_PROJECT_LOADED"),h("KEY_TOC_ORDER")],function(t){return function(){return c.get(h("KEY_PUBLISH_MODE"))?t.getTOCData():t.loadToc(i,"",function(){return t.widget.publish(h("EVT_TOC_LOADED"),!0),t.widget.subscribe(o.consts("KEY_TOPIC_ID"),t.subscribeTopicID)})}}(this))}return a(v,[{key:"expandBook",value:function(t,e,i,n){this.selectTocItem({id:e});var r=l.getAttribute(i,"data-itemkey");o.model.publish("EVT_TOC_LOADEDgototab",{tab:0,key:r,item:n})}},{key:"updateBookInfo",value:function(){var i=void 0,n=void 0;if(null!=(i=this.widget.get("active_bookid"))&&i!==this.widget.get(t)&&this.widget.publish(t,i),null!=(n=this.widget.get("active_level"))&&n!==this.widget.get(e))return this.widget.publish(e,n)}},{key:"updateActiveBookInfo",value:function(t,e){return this.widget.publish("active_bookid",e),this.widget.publish("active_level",t)}},{key:"getText",value:function(t){return t.textContent.trim()}},{key:"_getPreviousItemNode",value:function(t){var e=this.pid(l.getAttribute(t,"data-itemid"));return l.find(this.widget.node,'[data-itemid="'+e+'"]')[0]}},{key:"updateBreadcrumbInfo",value:function(t){var e=t,i=void 0,n=[];if(this.isTOCItem(t)){for(n.push(this._createBreadcrumbItem(e));i=this._getPreviousItemNode(e);)n.push(this._createBreadcrumbItem(i)),e=i;n.reverse(),n.length>0&&(n[n.length-1].lastNode=!0),n.curlevel=this.widget.get("curlevel"),this.widget.publish(f,n)}}},{key:"_createBreadcrumbItem",value:function(t){var e=t;this.hasTOCItemLink(t)||(e=this._findFirstLink(t));var i=e&&(l.getAttribute(e,"href")||l.getAttribute(e,"link"))||"#";return{id:l.getAttribute(t,"data-itemid"),text:this.getText(t),url:i,hasUrl:this.hasTOCItemLink(t),lastNode:!1}}},{key:"isTOCItem",value:function(t){return"LI"===l.nodeName(t)||l.getAttribute(t,"data-tocitem")}},{key:"_findFirstLink",value:function(t){var e={that:this},i=s.parentNode(t);return e.bookid=l.getAttribute(t,"data-itemid"),l.traverseNode(i,this._findLinkFn,null,null,e),e.linkNode}},{key:"_isParentTocItem",value:function(t){return this.bookNode!==t&&this.that.isTOCItem(t)}},{key:"_findLinkFn",value:function(t){return l.getAttribute(t,"data-itemid")===this.bookid&&(this.bookFound=!0),!this.bookFound||!this.that.hasTOCItemLink(t)||void 0!==this.linkNode||(this.linkNode=t,!1)}},{key:"nextLevel",value:function(t){var e=void 0;return e=u.parseInt(l.dataset(t,"itemlevel"),0),l.hasClass(t,"expanded")?e:e+1}},{key:"onClick",value:function(t){var e=void 0,i=void 0,n=void 0,r=void 0;if(r=t.currentTarget,e=t.target,i=this.hasLink(e),n=this.getItemNode(e,r),this.isBookNode(n)&&(i&&this.selectedNode!==n&&this.isOpenBook(n)||(this.toggleBook(n,!1),this.updateBreadcrumbInfo(n))),!(!i||this.isUrlNode(n)&&this.hasExternalLink(e)))return this.selectLink(n,!1)}},{key:"selectLink",value:function(t,e,i){if(null==i&&(i=700),this.selectedNode&&l.removeClass(this.selectedNode,"selected"),e&&this.selectedNode!==t&&u.delay(function(){return t.scrollIntoView(!1)},i),this.selectedNode=t,t)return this.updateBreadcrumbInfo(t),l.addClass(t,"selected")}},{key:"selectTocItem",value:function(t){var e=t.id+"_0";if(e){for(var i={},n=-1;e;)n++,i[e]=!0,e=e.substr(0,e.lastIndexOf("_"));this.widget.publish("show_child",i),this.widget.publish("curlevel",n),t.url&&o.model.publish("EVT_TOC_LOADEDgototab",{tab:0,item:{url:t.url}})}}},{key:"getItemNode",value:function(t,e){return u.findParentNode(t,e,this.isTOCItem)}},{key:"getChildItemNode",value:function(t,e){return l.find(t,function(t){return"LI"===l.nodeName(t)||l.getAttribute(t,"data-tocitem")})}},{key:"hasTOCItemLink",value:function(t){return"true"===l.getAttribute(t,"data-haslink")}},{key:"hasLink",value:function(t){var e=void 0;return(e=l.getAttribute(t,"href"))&&"#"!==e}},{key:"isBookNode",value:function(t){return l.hasClass(t,"book")}},{key:"isTopicNode",value:function(t){return l.hasClass(t,"item")}},{key:"isUrlNode",value:function(t){return l.hasClass(t,"url")}},{key:"isPageNode",value:function(t){return this.isTopicNode(t)||this.isUrlNode(t)}},{key:"isOpenBook",value:function(t){return this.widget.get(d)?l.hasClass(t,"active"):l.hasClass(t,"expanded")}},{key:"hasExternalLink",value:function(t){var e=void 0;return!(!(e=l.getAttribute(t,"href"))||u.isRelativeUrl(e)||u.isUrlAllowdInIframe(e))}},{key:"getBookNode",value:function(t,e){var i=void 0;return i=this.getItemNode(t,e),this.isBookNode(i)?i:null}},{key:"animateCollapse",value:function(t){return u.each([t,t.nextElementSibling],function(t){return l.addClass(t,"collapsing"),u.delay(function(){return l.removeClass(t,"collapsing")},700)})}},{key:"animateExpand",value:function(t){return u.each([t,t.nextElementSibling],function(t){return l.addClass(t,"expanding"),u.delay(function(){return l.removeClass(t,"expanding")},700)})}},{key:"toggleBook",value:function(t,e){return null==e&&(e=!0),this.isOpenBook(t)?this.closeBook(t):this.openBook(t,e)}},{key:"closeBook",value:function(t){var e=void 0,i=void 0;if(e=l.dataset(t,"itemid"),i="show_child"+e,!1!==this.widget.get(i)&&this.widget.publish(i,!1),this.updateActiveBookInfo(this.nextLevel(t),this.pid(e)),this.updateBookInfo(),l.hasClass(t,"expanded"))return l.removeClass(t,"expanded"),this.animateCollapse(t)}},{key:"openBook",value:function(t,e,i){var n=void 0,r=void 0,o=void 0,s=void 0;return null==i&&(i=this.updateBookInfo),o=l.dataset(t,"itemkey"),r=l.dataset(t,"itemid"),n=l.dataset(t,"childorder"),s="show_child"+r,!0!==this.widget.get(s)&&this.widget.publish(s,!0),this.updateActiveBookInfo(this.nextLevel(t),r),this.widget.get(o)?(l.hasClass(t,"expanded")||(l.addClass(t,"expanded"),this.animateExpand(t)),i()):(l.addClass(t,"loading-book"),e&&t.scrollIntoView(!1),this.loadToc(o,n,function(e){return function(){return l.removeClass(t,"loading-book"),l.addClass(t,"expanded"),e.animateExpand(t),i()}}(this)))}},{key:"extractTempData",value:function(){var t=void 0;return t=this.widget.get(o.consts("KEY_TEMP_DATA")),this.widget.publish(o.consts("KEY_TEMP_DATA")),t}},{key:"loadToc",value:function(t,e,i){var n=void 0,r=void 0,o=void 0,s=void 0;return s=this.parseKey(t),n=s.absRef,r=s.key,o=n?n+"/":"",u.loadScript(o+"whxdata/"+r+".new.js",!0,function(r){return function(){var o=void 0;return o=r.extractTempData()||[],u.each(o,function(t){if(t.absRef=n,e)return t.childOrder=e}),r.loadRefToc(o,function(e){if(r.widget.publish(t,e),i)return i()})}}(this))}},{key:"loadRefToc",value:function(t,e){var i=void 0,n=void 0,r=void 0;if(null==t&&(t=[]),-1!==(n=u.findIndex(t,function(t){if(t.ref)return!0}))){r=t[n],(i=r.absRef||"")&&(i+="/"),i+=r.ref;var o=c.get(h("KEY_TOC_ORDER"))[i].order;return u.loadScript(i+"/whxdata/toc.new.js",!0,function(r){return function(){var s=void 0;return s=r.extractTempData()||[],u.each(s,function(t){if(t.absRef=i,o)return t.childOrder=o}),Array.prototype.splice.apply(t,[n,1].concat(s)),r.loadRefToc(t,e)}}(this))}if(e)return e(t)}},{key:"getTOCData",value:function(){return c.subscribeOnce(h("KEY_PUBLISH_BASE_URL"),function(t){return function(){var e;try{return c.subscribe(h("KEY_PROJECT_LIST"),function(e){return c.subscribe(h("KEY_MASTER_PROJECT_LIST"),function(n){var r,s;return s=n.length,r=[],u.each(n,function(t){return(t=u.makeRelativeUrl(t,e[0]))&&(t+="/"),u.loadScript(t+"whxdata/toc.new.js",!0,function(e){return function(){var n;return n=e.extractTempData()||[],u.each(n,function(e){e.absRef=t}),e.loadRefToc(n,function(t){if(s--,r=r.concat(t),0===s)return e.widget.publish(i,r),e.widget.publish(h("EVT_TOC_LOADED"),!0),e.widget.subscribe(o.consts("KEY_TOPIC_ID"),e.subscribeTopicID)})}}(this))},t)})})}catch(t){if(e=t,o._debug)return o._d("warn",e.message)}}}(this))}},{key:"nextChildOrder",value:function(t){var e=void 0;return e=t.split("@"),e[e.length-1]=1+u.parseInt(e[e.length-1],0),e.join("@")}},{key:"childOrder",value:function(t){return t?t+"@1":"@1"}},{key:"pid",value:function(t){var e=void 0;return(e=t.split("_")).pop(),e.join("_")||"_"}},{key:"key",value:function(t,e){var i=void 0;return null==t&&(t=""),-1===(i=u.findIndex(this.projectAbsRef,function(e){return e===t}))&&(i=this.projectAbsRef.length,this.projectAbsRef.push(t)),".p.child_toc."+i+"."+e}},{key:"parseKey",value:function(t){var e=void 0,i=void 0,n=void 0;return t=t.substring(3),i=t.split("."),n=i.pop(),e=this.projectAbsRef[i.pop()]||"",{key:n,absRef:e}}},{key:"url",value:function(t,e){var i=void 0,n=void 0,r=void 0,o=void 0,s=void 0;return t.url?(o=t.absRef?u.ensureSlash(t.absRef):"",s=""+o+t.url,(i=u.extractHashString(s)).length>0&&(i="#"+i,n=u.filePath(s),(r=u.extractParamString(s)).length>0&&(r+="&"),s=""+n+(r="?"+r+"rhtocid="+e)+i),encodeURI(s)):"#"}},{key:"tags",value:function(t){var e=void 0;return e=t.absRef?"+"+t.absRef:"",t["data-rhtags"]?t["data-rhtags"]+e:""}},{key:"subscribeTopicID",value:function(t){var e=this,i=void 0,n=void 0;null==t&&(t={}),(n=u.hashParams().rhtocid)?(i=this.getPathfromId(n),this.selectTocById(i,this.widget.node)):o.model.subscribe(o.consts("KEY_MASTER_PROJECT_LIST"),function(i){if(i&&i.length<2)return e.syncToc.sync(e,t)})}},{key:"subscribeBookId",value:function(t){var e=void 0;if(t)return e=this.getPathfromId(t),this.selectTocById(e,this.widget.node,null,void 0)}},{key:"getPathfromId",value:function(t){var e=void 0;return(e=t.split("_")).shift(),e=u.map(e,function(t){return u.parseInt(t,0)})}},{key:"selectTocById",value:function(t,e,i,n){var r=void 0,o=void 0;if(null==i&&(i=1),e&&e.children&&(o=t.shift(),r=u.find(e.children,function(t){if(this.isBookNode(t)||this.isPageNode(t)){if(0===o)return!0;o--}return!1},this)))return 0===t.length&&this.selectLink(r,!0,i),this.isBookNode(r)?this.openBook(r,!0,function(e){return function(){return u.defer(function(){var i=void 0,n=void 0;return 0===t.length?e.updateBookInfo():(i=r.nextElementSibling,n=i.children&&i.children[0],e.selectTocById(t,n,700))})}}(this)):this.updateBookInfo()}}]),v}();return v.prototype.class=function(t){return"remoteitem"===t.type?"url":t.type},v}(),o.controller("TocController",p)},{"../../src/lib/rh":8,"../../src/responsive_help/utils/node_utils":37}],6:[function(t,e,i){var n=t("../../src/lib/rh"),o=n._,s=(n.$,n.model),u=n.consts;new(function(){function t(){var e=this;r(this,t),this.data={"":{order:"",nextChild:0}},s.subscribeOnce(u("KEY_PROJECT_LIST"),function(t){o.each(t,function(i){i=o.makeRelativeUrl(e.trimFirst(i,"."),t[0]),e.childOrder(i)}),s.publish(u("KEY_TOC_ORDER"),e.data)})}return a(t,[{key:"trimFirst",value:function(t,e){return t=t.length&&t[0]===e&&t[1]!==e?t.substring(1):t}},{key:"childOrder",value:function(t){if(t=this.trimFirst(t,"/"),!this.data[t]){var e=t;e=(e=e.substring(0,e.lastIndexOf("/"))).substring(0,e.lastIndexOf("/"));var i=this.data[e];i.nextChild++,this.data[t]={order:i.order+"@"+i.nextChild,nextChild:0}}return this.data[t].order}}]),t}())},{"../../src/lib/rh":8}],7:[function(i,n,o){var s=t.rh,u=s.model,l=s._,c=s.consts,h=s.http,d=s.rhs,_=function(){var t=void 0;return(_=function(){function i(){r(this,i);u.subscribeOnce(c("EVT_PROJECT_LOADED"),function(){return u.subscribeOnce(c("KEY_PUBLISH_MODE"),function(e){if(e){var i=i||t(),n=[],r=l.debounce(function(){return h.post(i,JSON.stringify(n)).error(function(t,e){if(s._debug)return s._d("error","Filter report status ",e)})},3e3,!1);return u.subscribe(c("KEY_TAG_EXPRESSION"),function(t){n=[];var e=s.model.get(c("KEY_MERGED_FILTER_KEY")),i=!0,o=!1,a=void 0;try{for(var u,l=Array.from(t)[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var h=u.value,d=!0,_=!1,p=void 0;try{for(var f,v=Array.from(h.c)[Symbol.iterator]();!(d=(f=v.next()).done);d=!0){var g,E=f.value;(g=s.filterObject.lookup(e,E,!1))&&n.push(g.display)}}catch(t){_=!0,p=t}finally{try{!d&&v.return&&v.return()}finally{if(_)throw p}}}}catch(t){o=!0,a=t}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}if(n.length>0)return r()})}})})}return a(i,null,[{key:"initClass",value:function(){t=function(){var t=e.location.origin,i=u.get(c("KEY_PUBLISH_BASE_URL")).substr(t.length);if(i&&!l.isEmptyString(i)){return i+"?"+l.mapToEncodedString(l.extend(l.addPathNameKey({area:d.area(),prj:d.project(),type:d.type(),agt:"fltRpt",mgr:"agm"})))}}}}]),i}()).initClass(),_}();new _},{}],8:[function(e,i,n){(function(t){void 0===t.rh&&(t.rh={}),i.exports=t.rh}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0!==t?t:{})},{}],9:[function(t,e,i){t("../lib/rh"),t("./layout/ui/carousel"),t("./layout/home_controller"),t("../../lenient_src/layout/search_util"),t("./layout/search/search_controller"),t("./layout/favorites_controller"),t("./layout/toc_breadcrumbs_controller.js"),t("../../lenient_src/layout/toc_order"),t("../../lenient_src/layout/toc_controller"),t("../../lenient_src/layout/index_controller"),t("../../lenient_src/layout/glossary_controller"),t("../../lenient_src/layout/event_handlers"),t("./layout/rh2017layoutcontroller"),t("./layout/modal_dialog"),t("./layout/search_result_controller.js"),t("../../lenient_src/robohelp/layout/filter_handler")},{"../../lenient_src/layout/event_handlers":1,"../../lenient_src/layout/glossary_controller":2,"../../lenient_src/layout/index_controller":3,"../../lenient_src/layout/search_util":4,"../../lenient_src/layout/toc_controller":5,"../../lenient_src/layout/toc_order":6,"../../lenient_src/robohelp/layout/filter_handler":7,"../lib/rh":8,"./layout/favorites_controller":10,"./layout/home_controller":11,"./layout/modal_dialog":12,"./layout/rh2017layoutcontroller":13,"./layout/search/search_controller":30,"./layout/search_result_controller.js":34,"./layout/toc_breadcrumbs_controller.js":35,"./layout/ui/carousel":36}],10:[function(t,i,n){var o=t("../../lib/rh"),s=o.consts,u=function(){function t(e){var i=this;r(this,t),this.widget=e,this.favStorage=new o.Storage,this._loadFromStorage=!1,this._favMemoryStore=void 0,o.model.subscribeOnce(s("EVT_PROJECT_LOADED"),function(){i.init()})}return a(t,[{key:"_getUniqueId",value:function(){function t(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return t()+t(!0)+t(!0)+t()}},{key:"numberOfItems",value:function(t){return Object.keys(t).length}},{key:"_getFavHTMLElements",value:function(t){for(var i=e.getElementsByTagName("div"),n=[],r=0;r<i.length;r++)i[r].getAttribute(o.consts("FAVATTRIBUTE"))===t&&n.push(i[r]);return n}},{key:"getLinkTitle",value:function(t){var e=o.model.get(s("KEY_LNG"));return t?e&&e.unsetAsFavorite||"":e&&e.setAsFavorite||""}},{key:"_loadFavoritesFromStorage",value:function(){var t=this.favStorage.fetch(s("FAVSTORAGE"));return void 0===t||null===t?{}:JSON.parse(t)}},{key:"_loadFavorites",value:function(){return!1===this._loadFromStorage&&(this._favMemoryStore=this._loadFavoritesFromStorage()),this._favMemoryStore}},{key:"_saveFavorites",value:function(){var t=void 0;t=JSON.stringify(this._favMemoryStore),this.favStorage.persist(o.consts("FAVSTORAGE"),t)}},{key:"_unFavoriteTopic",value:function(t){for(var e in this._favMemoryStore){if(this._favMemoryStore[e].topic===t){delete this._favMemoryStore[e];break}}this._saveFavorites(),o.model.publish(o.consts("EVENTFAVCHANGE"),null)}},{key:"_favoriteTopic",value:function(t,e){this._favMemoryStore[this._getUniqueId()]={topic:t,title:e},this._saveFavorites(),o.model.publish(o.consts("EVENTFAVCHANGE"),null)}},{key:"getStorageId",value:function(){return"fav-"+o._.getHostFolder()}},{key:"getTopicURL",value:function(){return o.model.get(o.consts("KEY_TOPIC_URL"))}},{key:"getTopicTitle",value:function(){return o.model.get(o.consts("KEY_TOPIC_TITLE"))}},{key:"isTopicFavorite",value:function(t){var e=void 0,i=void 0;t||(t=this.getTopicURL()),e=this._loadFavorites(),i=!1;for(var n in e){if(e[n].topic===t){i=!0;break}}return i}},{key:"setfavoritesTitle",value:function(t){var e=this.getLinkTitle(t);o.model.publish(s("FAVORITES_BUTTON_TITLE"),e)}},{key:"setTopicFavoriteState",value:function(){o.model.publish(s("TOPIC_FAVORITE"),this.isTopicFavorite())}},{key:"setFavoritesList",value:function(){var t=[],e=void 0,i=this._loadFavorites();for(e in i)t.push(i[e]);o.model.publish(s("KEY_FAVORITES"),t)}},{key:"toggleFavorite",value:function(t){t||(t=this.getTopicURL()),this.isTopicFavorite(t)?this._unFavoriteTopic(t):this._favoriteTopic(t,this.getTopicTitle()),this.setTopicFavoriteState()}},{key:"init",value:function(){this.favStorage.init(o._.getRootUrl()),o.model.subscribe(o.consts("KEY_TOPIC_URL"),this.setTopicFavoriteState.bind(this)),o.model.subscribe(o.consts("EVENTFAVCHANGE"),this.setFavoritesList.bind(this)),o.model.subscribe(o.consts("TOPIC_FAVORITE"),this.setfavoritesTitle.bind(this)),this.setFavoritesList(),o.model.publish(s("TOPIC_FAVORITE"),this.isTopicFavorite())}}]),t}();o.controller("FavoritesController",u)},{"../../lib/rh":8}],11:[function(e,i,n){var o=e("../../lib/rh"),s=o._,u=function(){function e(t){r(this,e),this.widget=t}return a(e,[{key:"goToHome",value:function(t){if(o.consts("HOME_FILEPATH")===o._.getFileName())return this.changeToDefaultTopic(t);var e=void 0;return void 0!==t&&""!==t&&(e={rhtocid:t}),s.goToHome(e),!0}},{key:"changeToDefaultTopic",value:function(e){var i={t:t.gDefaultTopic.substring(1)};return void 0!==e&&""!==e&&(i.rhtocid=e),s.queueUpdateHashMap(i,!0),!0}}]),e}();o.controller("HomeController",u)},{"../../lib/rh":8}],12:[function(i,n,o){var s=i("../../lib/rh"),u=i("../utils/node_utils"),l=s.$,c=s._,h=function(){function i(){r(this,i)}return a(i,[{key:"createChildWidget",value:function(){this.node=l.createElement("div",this.template),u.appendChild(e.body,this.node),this.widget=new s.Widget({node:this.node}),this.widget.init()}},{key:"setOnImageLoad",value:function(){var t=l.find(this.node,".rh-modal-content")[0];if(t){this.modalContent=t;var e=l.find(t,"img")[0];e&&(this.img=e,e.addEventListener("load",this.setModalSize.bind(this)),e.addEventListener("error",this.setModalSize.bind(this)))}}},{key:"setModalSize",value:function(){this.imageWidth=this.img.naturalWidth,this.imageHeight=this.img.naturalHeight;var t=this.calculatePosition(this.imageWidth,this.imageHeight),e=l.find(this.node,".rh-modal-container")[0];e&&this.setContainerStyle(e,t)}},{key:"setContainerStyle",value:function(t,e){var i=Math.round(e.top),n=Math.round(e.left);l.css(t,"left",n.toString()+"px"),l.css(t,"top",i.toString()+"px"),this.modalContent&&this.setImageSize(e.width,e.height),l.css(t,"display","block")}},{key:"calculateImageSize",value:function(t){var e=t.imageWidth/t.imageHeight;return t.imageWidth<t.pageWidth&&t.imageHeight<t.pageHeight?{width:t.imageWidth,height:t.imageHeight}:t.imageWidth>=t.pageWidth&&t.imageHeight<=t.pageHeight?{height:t.pageWidth/e,width:t.pageWidth}:t.imageWidth<=t.pageWidth&&t.imageHeight>=t.pageHeight?{height:t.pageHeight,width:t.pageHeight*e}:t.imageWidth>=t.pageWidth&&t.imageHeight>=t.pageHeight?this._calculateFullyExceedSize(t,e):void 0}},{key:"_calculateFullyExceedSize",value:function(t,e){return e<t.pageWidth/t.pageHeight?{height:t.pageHeight,width:t.pageHeight*e}:{height:t.pageWidth/e,width:t.pageWidth}}},{key:"calculatePosition",value:function(i,n){var r=t.innerWidth||e.body.clientWidth,o=t.innerHeight||e.body.clientHeight;o-=70;var s={imageWidth:i,imageHeight:n,pageWidth:r=(r-=70)>=0?r:0,pageHeight:o=o>=0?o:0},a=this.calculateImageSize(s);i=a.width,n=a.height;return{left:Math.max(5,(r-i)/2),top:Math.max(5,(o-n)/2),width:i,height:n,pageWidth:r,pageHeight:o}}},{key:"initialStyle",value:function(){return this.isImage?'style="display:none"':""}},{key:"ShowModal",value:function(t){this.isImage=t.isImage,this.createChildWidget(),this.widget.subscribe("close",this._close.bind(this)),this.widget.publish("content",t.content),c.defer(this.setOnImageLoad.bind(this))}},{key:"setImageSize",value:function(t,e){this.imageWidth>t&&l.css(this.img,"width",Math.round(t)+"px"),this.imageHeight>e&&l.css(this.img,"height",Math.round(e)+"px")}},{key:"_close",value:function(){this.widget.destruct(),this.widget=void 0,u.removeChild(this.node),this.node=void 0}},{key:"template",get:function(){return'\n    <div class="rh-modal">\n        <div class="rh-modal-container" '+this.initialStyle()+'>\n          <div class="rh-modal-content" data-html="content"></div>\n          <div class="rh-modal-close" data-click="@close(true)"> </div>\n        </div>\n    </div>'}}]),i}();s.model.csubscribe("SHOW_MODAL",function(t){(new h).ShowModal(t)})},{"../../lib/rh":8,"../utils/node_utils":37}],13:[function(t,i,o){var s=t("../../lib/rh"),u=s.$,l=s._,c=s.consts,h=function(){function t(e){r(this,t),this.widget=e,this.topicFrame=".topic-container iframe",this.initLayout(),this.initModal()}return a(t,[{key:"isLayoutMode",value:function(t){var e=t||l.hashParams(),i=e[s.consts("HASH_KEY_TOPIC")];return e[s.consts("HASH_KEY_UIMODE")]!==c("HELP_SEARCH_MODE")&&(!i||"true"===e[s.consts("HASH_HOMEPAGE_MODE")]||e[s.consts("HASH_KEY_RH_TOCID")])}},{key:"initLayout",value:function(){var t=this;s.model.subscribe(c("EVT_HASH_CHANGE"),function(e){var i=e.newMap,r=e.oldMap;t.isLayoutMode()?t.widget.publish(s.consts("KEY_VIEW_MODE"),s.consts("HELP_LAYOUT_MODE")):"search"===i[s.consts("HASH_KEY_UIMODE")]?(t.widget.publish(s.consts("KEY_VIEW_MODE"),s.consts("HELP_SEARCH_MODE")),l.queueUpdateHashMap(n({},c("HASH_HOMEPAGE_MODE"),!1),!1)):t.widget.publish(s.consts("KEY_VIEW_MODE"),s.consts("HELP_TOPIC_MODE"));var o=s.model.get(s.consts("KEY_FEATURE"));o&&!1===o.showDefTopic&&!i[s.consts("HASH_KEY_RH_TOCID")]&&!r[s.consts("HASH_KEY_TOPIC")]&&i[s.consts("HASH_KEY_TOPIC")]?l.queueUpdateHashMap(n({},c("HASH_HOMEPAGE_MODE"),"false"),!1):r[s.consts("HASH_KEY_TOPIC")]&&!i[s.consts("HASH_KEY_RH_TOCID")]&&r[s.consts("HASH_KEY_TOPIC")]!==i[s.consts("HASH_KEY_TOPIC")]&&"true"===i[s.consts("HASH_HOMEPAGE_MODE")]&&r[s.consts("HASH_HOMEPAGE_MODE")]===i[s.consts("HASH_HOMEPAGE_MODE")]&&l.queueUpdateHashMap(n({},c("HASH_HOMEPAGE_MODE"),"false"),!1)});var e=l.hashParams();this.isLayoutMode()&&"true"!==e[s.consts("HASH_HOMEPAGE_MODE")]&&l.queueUpdateHashMap(n({},c("HASH_HOMEPAGE_MODE"),!0),!1),s.model.subscribe("EVT_TOC_LOADEDgototab",function(e){e.key&&s.model.subscribe(e.key,function(t,i,n){n(),e.item&&e.item.url&&!t[0].added&&(t.unshift({type:"item",url:e.item.url,name:e.item.name,added:!0}),s.model.publish(e.key,t))}),e.item.url&&t.viewTopicInLayoutMode(e.item.url)})}},{key:"viewTopicInLayoutMode",value:function(t){var e=n({homepage:"true"},s.consts("HASH_KEY_RH_TOCID"),!0);t&&"#"!==t&&(e.t=t),l.queueUpdateHashMap(e,!1)}},{key:"initModal",value:function(){var t=!1;e.addEventListener("keydown",function(t){27===t.keyCode&&s._.each(u.find(".modal"),function(t){u.addClass(t,"rh-hide")})},!1),e.addEventListener("click",function(){t||s._.each(u.find(".modal"),function(t){u.addClass(t,"rh-hide")}),t=!1}),s._.each(u.find(".modal-content"),function(e){l.addEventListener(e,"click",function(){t=!0})})}}]),t}();s.controller("RH2017LayoutController",h)},{"../../lib/rh":8}],14:[function(t,e,i){e.exports={minPreviousThreshold:.2,previousnGram:1,max_predictions:5,PREDICTOR_SOURCE_ID:{HISTORY_PREDICTOR:0,NGRAM_PREDICTOR:1,GENERAL_PREDICTOR:2,CORRECTOR:3}}},{}],15:[function(t,e,i){var n=t("./indices"),o=t("../../../lib/rh")._,s=t("./prediction"),u=t("./consts"),l=t("./utils"),c=t("./prediction_list"),h=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;r(this,t),this._loader=e,this.predictions=[],this.max_predictions=n,this._callback=i}return a(t,[{key:"getCorrections",value:function(t){this._parsed_input=t,this.predictions=[],this._computePredictions();var e=this._loader.getHashes(this._parsed_input._partial);if(e)for(var i=e.length,n=0;n<i&&this.predictions.length<this.max_predictions;n++){var r=e[n];this._addCorrection(r)}this.onResultCalculated()}},{key:"clear",value:function(){this.predictions=[]}},{key:"_computePredictions",value:function(){var t=this._loader.getHashes(this._parsed_input._partial);t&&this._addCorrection(t)}},{key:"onResultCalculated",value:function(){this._callback&&this._callback(new c(this.predictions,this._parsed_input),this._loader)}},{key:"_matchCorrection",value:function(t){return this._hamming_dist=this._getDistance(t),this._hamming_dist<=2&&!this._loader.isStopWord(t)}},{key:"_addCorrection",value:function(t){if(t){var e=l.getSafeElement(t,n.MAP.WORD);if(e&&this._matchCorrection(e)){var i=this._parsed_input.replaceLastWord(e),r=this._parsed_input.completeSuggestion(i),o=new s(r,1/this._hamming_dist,2,u.PREDICTOR_SOURCE_ID.CORRECTOR);this.predictions.push(o)}}}},{key:"_getDistance",value:function(t){return o.findEditDist(this._parsed_input._partial,t)}}]),t}();e.exports=h},{"../../../lib/rh":8,"./consts":14,"./indices":20,"./prediction":26,"./prediction_list":28,"./utils":33}],16:[function(t,e,i){var n=function(){function t(e){r(this,t),this._callback=e,this._count=0}return a(t,[{key:"signal",value:function(){this._count++,this._count>=0&&this._callback&&this._callback()}},{key:"wait",value:function(t){var e=t||1;this._count-=e}}]),t}();e.exports=n},{}],17:[function(t,e,i){var n=t("./prediction_list"),o=t("./prediction_creator"),s=t("./consts"),u=t("./indices"),l=t("../../../lib/rh")._,c=t("./merger"),h=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;r(this,t),this._max_predictions=n,this._loader=i,this.total_count=this._loader.getTotalCount(),this._callback=e,this._source=s.PREDICTOR_SOURCE_ID.GENERAL_PREDICTOR,this.prediction_merger=new c([],5*this.total_count)}return a(t,[{key:"clear",value:function(){this.prediction_merger.clear(),this.parsed_input=void 0}},{key:"getPredictions",value:function(t){this._init(t),this._computePredictions(),this._onResultComputed()}},{key:"_computePredictions",value:function(){var t=this._getWordHashes();t&&this._addPredictions(t)}},{key:"_isWholeWordInput",value:function(){return this.parsed_input.isWholeWord}},{key:"_getWordHashes",value:function(){return this.parsed_input.isWholeWord?this._loader.top_words:this._loader.getHashes(this.parsed_input._partial)}},{key:"_init",value:function(t){this.prediction_merger=new c([],5*this.total_count),this.parsed_input=t}},{key:"_onResultComputed",value:function(){this._callback&&this._callback(new n(this.predictions,this.parsed_input),this._loader)}},{key:"_addPredictions",value:function(t){if(t)for(var e=t.length,i=0;i<e&&this.predictions.length<this.max_predictions;i++){var n=t[i];this._addWordPrediction(n)}}},{key:"_addWordPrediction",value:function(t,e){e=e||this._matches_partially.bind(this);var i=this._loader.getModelData(t),n=this._loader.total_count;if(e(t)){var r=t[u.MAP.WORD];this._should_add_prediction(r)&&this._create_predictions(t,n,i)}}},{key:"_continueFn",value:function(){return!0}},{key:"_should_add_prediction",value:function(t){return!this._loader.isStopWord(t)&&!this.parsed_input.equalLastWord(t)}},{key:"_matches_partially",value:function(t){if(this.parsed_input.isWholeWord)return!0;var e=t[u.MAP.WORD];return this.parsed_input.comparePartial(e)}},{key:"_create_predictions",value:function(t,e,i){var n=this,r=new o({loader:this._loader,model_item:i,total_count:e,parsed_input:this.parsed_input,continueFn:this._continueFn}).getMultiPredictions(t,!0,void 0,this._source);l.each(r,function(t){void 0!==t&&n.prediction_merger.mergePrediction(t)})}},{key:"_calculate_probability",value:function(t){return t/this.total_count}},{key:"predictions",get:function(){return this.prediction_merger.predictions}},{key:"max_predictions",set:function(t){this._max_predictions=t},get:function(){return this._max_predictions}}]),t}();e.exports=h},{"../../../lib/rh":8,"./consts":14,"./indices":20,"./merger":23,"./prediction_creator":27,"./prediction_list":28}],18:[function(t,e,i){var n=t("../../../lib/rh")._,o=t("./prediction"),s=t("./input_parser"),u=t("./prediction_list"),l=t("./consts"),c=function(){function t(e,i){r(this,t),this._reader=e,this._predictions=[],this._callback=i,this._source=l.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR,this._max_predictions=void 0===l._max_history_predictions?2:l._max_history_predictions}return a(t,[{key:"getPredictions",value:function(t){return this._predictions=[],this._parsed_input=t,this._computePredictions(),this._callback&&this._callback(new u(this._predictions,this._parsed_input)),this._predictions}},{key:"init",value:function(){}},{key:"clear",value:function(){this._predictions=[]}},{key:"_computePredictions",value:function(){var t=this;""!==this._parsed_input.trimmedText&&(n.each(this._reader._list,function(e){t._match(e.text)&&t._predictions.push(t._createPrediction(e))}),this._purge())}},{key:"_purge",value:function(){this._predictions.splice(this._max_predictions)}},{key:"_createPrediction",value:function(t){return new o(t.text,1,t.count,this._source)}},{key:"_match",value:function(t){if(this._parsed_input.original_text.length>t.length)return!1;var e=new s(t,!0);return this._parsed_input.compare(e)}}]),t}();e.exports=c},{"../../../lib/rh":8,"./consts":14,"./input_parser":21,"./prediction":26,"./prediction_list":28}],19:[function(t,e,i){var n=t("../../../lib/rh")._,o=t("./utils"),s=function(){function t(){r(this,t)}return a(t,[{key:"initHistory",value:function(t){void 0===this._list&&(this._list=t||[])}},{key:"getHistory",value:function(){return this._list||[]}},{key:"_updateText",value:function(t,e){this.getHistory().splice(e,1),this.getHistory().unshift(t)}},{key:"_addNewText",value:function(t){this.getHistory().push(t)}},{key:"add",value:function(t){var e=n.findIndex(this.getHistory(),function(e){return 0===o.compareNoCase(t.text,e.text)});e>=0?this._updateText(t,e):this._addNewText(t)}},{key:"delete",value:function(t){var e=n.findIndex(this.getHistory(),function(e){return 0===o.compareNoCase(t,e.text)});e>=0&&this.getHistory().splice(e)}}]),t}();e.exports=new s},{"../../../lib/rh":8,"./utils":33}],20:[function(t,e,i){e.exports={MAP:{WORD:0,HASH:1,COUNT:2,MODEL_FILE_NO:3,MODEL_INDEX:4,TOPICS:5},MODEL:{WORD_HASH:0,COUNT:1,NEXT_MODEL:2},FIRST_PREDICTION:{NEXT:0,PREVIOUS:1}}},{}],21:[function(t,e,i){var n=t("./utils"),o=t("../../../../src/lib/rh")._,s=function(){function t(e,i,n,o){r(this,t),this.isPrevious=o,this.selection=void 0===n?e.length:n;var s=this._calculateSeparator(e);this.isPrevious||(this.isWholeWord=i||this._isWholeWord(e,s)),this.initText(e,s)}return a(t,[{key:"initText",value:function(t,e){this._computeText(t,e),this.trimmedText=this.original_text.trim(),this.words=o.compact(this.trimmedText.split(" ")||[]),this._reverseIfPrevious(),!this.isWholeWord&&this.words.length>0&&(this._partial=this.words.splice(-1)[0])}},{key:"_computeText",value:function(t,e){this._right_text="",this._left_text="",void 0===e&&(e=t.length),this.isSplitText=!(0===e||e===t.length);var i=t.substring(0,e),n=t.substring(e);this.isPrevious?(this.original_text=n,this._left_text=i.trim()):(this.original_text=i,this._right_text=n.trim())}},{key:"equalRemaingWord",value:function(t){if(""!==this._left_text||""!==this._right_text){var e=this._getRemainigWord();if(e)return 0===n.compareNoCase(e,t)}return!1}},{key:"_getRemainigWord",value:function(){var t=this.isPrevious?this._left_text.split(" "):this._right_text.split(" ");if(t=t||[],(t=o.compact(t)).length>0)return this.isPrevious?t[t.length-1]:t[0]}},{key:"completeSuggestion",value:function(t){return this.isPrevious?0===this._left_text.length?t:this._left_text+" "+t:0===this._right_text.length?t:t+" "+this._right_text}},{key:"_calculateSeparator",value:function(t){if(this.isPrevious){if(0===this.selection)return this.isWholeWord=!0,0;if(t.length>this.selection&&" "!==t[this.selection-1]){var e=t.lastIndexOf(" ",this.selection-1);return this.isWholeWord=!1,e>=0?e+1:0}this.isWholeWord=!0}return this.selection}},{key:"_reverseIfPrevious",value:function(){this.isPrevious&&this.words.reverse()}},{key:"_isWholeWord",value:function(t,e){return this.isPrevious?0===e||t.length>e&&" "===t[e-1]:e>0&&" "===t[e-1]}},{key:"compare",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(i=void 0===i?this.words.length-1:i,this.words.length>t.words.length)return!1;for(var r=e;r<=i;r++){var o=this.words[r],s=t.words[r];if(0!==n.compareNoCase(o,s))return!1}return this.matchPartial(t,r)}},{key:"matchPartial",value:function(t,e){if(void 0===this._partial)return!0;if(t.words.length<=e)return!1;var i=t.words[e];return this.comparePartial(i)}},{key:"comparePartial",value:function(t){return this._matchExp=new RegExp("^"+this._partial,"i"),this._matchExp.test(t)}},{key:"completeWord",value:function(t){return this.isWholeWord||void 0===this._partial||0===this._partial.length?this.getTermForCompleteWord(t,this.trimmedText):this.getTermForPartialText(t)}},{key:"getTermForPartialText",value:function(t){var e=t.substring(this._partial.length,t.length);if(this.isPrevious){var i="",n=this.trimmedText.indexOf(" ");return n>=0&&(i=this.trimmedText.substring(n)),this._partial+e+i}return this.trimmedText+e}},{key:"getTermForCompleteWord",value:function(t){return this.isPrevious?t+" "+this.trimmedText:this.trimmedText+" "+t}},{key:"replaceLastWord",value:function(t){var e=this.trimmedText;if(void 0!==this._partial&&!this.isWholeWord){var i=this.trimmedText.length-this._partial.length;e=(e=this.trimmedText.substring(0,i)).trim()}return e+" "+t}},{key:"equalLastWord",value:function(t){if(0===this.words.length)return!1;var e=this.words[this.words.length-1];return 0===n.compareNoCase(e,t)}}]),t}();e.exports=s},{"../../../../src/lib/rh":8,"./utils":33}],22:[function(t,e,i){var n=t("../../../lib/rh"),o=n._,s=n.model,u=t("./utils"),l=t("./indices"),c=t("./consts"),h=t("./paths"),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";r(this,t),this._paths=new h(e)}return a(t,[{key:"init",value:function(t){this.loadIndex(t),this.loadMap(t)}},{key:"_isIndexLoaded",value:function(){return void 0!==this.index_data}},{key:"getModelCount",value:function(){return this.index_data.Model.length}},{key:"getMapHash",value:function(t){return this._hash_to_word[t]}},{key:"getHashes",value:function(t){if(void 0!==t&&t.length>0)return this.getAplhabetHashes(t[0])}},{key:"getAplhabetHashes",value:function(t){if(this.map_data&&1===t.length){var e=t.toLowerCase();return this.map_data[e]}}},{key:"getWordModel",value:function(t,e){var i=void 0,n=this._getHashForWord(t);return n&&e&&(i=e[n[l.MAP.MODEL_INDEX]]),i}},{key:"getCount",value:function(t){var e=this._getHashForWord(t);if(e)return e[l.MAP.COUNT]}},{key:"getModelData",value:function(t){var e=t[l.MAP.MODEL_FILE_NO],i=t[l.MAP.MODEL_INDEX],n=s.get(this._paths.getModelKey(e));return n||this.loadModel(e),n&&n[i]}},{key:"_compareWordCount",value:function(t,e){var i=u.getSafeElement(t,l.MAP.COUNT),n=u.getSafeElement(e,l.MAP.COUNT);return i&&n?n-i:0}},{key:"_buildTopWords",value:function(t){t.sort(this._compareWordCount),t.splice(100*c.max_predictions),this._top_words=t}},{key:"getModelFileNo",value:function(t){var e=this._getHashForWord(t);if(e)return e[l.MAP.MODEL_FILE_NO]}},{key:"_getHashForWord",value:function(t){var e=void 0,i=this.getHashKey(t);return i&&(e=this._hash_to_word[i]),e}},{key:"getHashKey",value:function(t){if(t&&t.length>0){var e=t.toLowerCase();return this._word_hash[e]}}},{key:"loadIndex",value:function(t){var e=this;!1===this._isIndexLoaded()?o.loadScript(this._paths.getIndexFilePath(),!0,function(){e.index_data=o.exports(),e.onIndexLoaded(t)},!0):this.onIndexLoaded(t)}},{key:"loadModel",value:function(t,e){if(void 0!==t){var i=this._paths.getModelKey(t),n=s.get(i);if(void 0===n){s.publish(i,null);var r=this._paths.getModelFilePath(t);o.loadScript(r,!0,this.getOnModelLoadFn(t,e),!0)}else null===n&&void 0!==e?s.subscribe(i,e):this.doCallback(e,n,t)}else this.doCallback(e,[],t)}},{key:"doCallback",value:function(t,e,i){t&&t(e,i)}},{key:"getOnModelLoadFn",value:function(t,e){var i=this;return function(){var n=o.exports();s.publish(i._paths.getModelKey(t),n),e&&e(n,t)}}},{key:"onMapLoaded",value:function(t){this.parseMap(),this.index_data&&t&&t(this)}},{key:"onIndexLoaded",value:function(t){this.map_data&&t&&t(this)}},{key:"parseMap",value:function(){var t=this.map_data;this._word_hash={},this._hash_to_word={};var e=[];for(var i in t){var n=t[i];this._parseWordsData(n),e=e.concat(n)}this._buildTopWords(e)}},{key:"_parseWordsData",value:function(t){var e=this;o.each(t,function(t){var i=parseInt(t[l.MAP.HASH]);if(t[l.MAP.WORD]){var n=t[l.MAP.WORD].toString();e._word_hash[n]=i}e._hash_to_word[i]=t})}},{key:"isStopWord",value:function(t){return void 0!==o.find(this.index_data.stopWords,function(e){return 0===u.compareNoCase(t,e)})}},{key:"getTotalCount",value:function(){return this.index_data.totalCount}},{key:"wordHashfromIndexKey",value:function(t,e){return o.find(this._hash_to_word,function(i){return i[l.MAP.MODEL_INDEX]===t&&i[l.MAP.MODEL_FILE_NO]===e})}},{key:"loadMap",value:function(t){var e=this;void 0===this.map_data?o.loadScript(this._paths.getMapFilePath(),!0,function(){e.map_data=o.exports(),e.onMapLoaded(t)},!0):this.onMapLoaded(t)}},{key:"top_words",get:function(){return this._top_words}},{key:"nGram",get:function(){return this.index_data.nGram}},{key:"search_model",get:function(){return this.index_data.Model}},{key:"search_map",get:function(){return this.index_data.Map}},{key:"total_count",get:function(){return this.index_data.totalCount}},{key:"stop_words",get:function(){return this.index_data.stopWords}}]),t}();e.exports=d},{"../../../lib/rh":8,"./consts":14,"./indices":20,"./paths":25,"./utils":33}],23:[function(t,e,i){var n=t("../../../lib/rh")._,o=t("./utils"),s=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;r(this,t),this._predictions=e,this._max_predictions=i}return a(t,[{key:"merge",value:function(t){var e=this;n.each(t,function(t){e.mergePrediction(t)}),this._sort(),this._purge()}},{key:"clear",value:function(){this._predictions=[]}},{key:"_purge",value:function(){this._predictions.length>this._max_predictions&&this._predictions.splice(this._max_predictions)}},{key:"mergePrediction",value:function(t){var e=this.find_prediction(t.term);e?this.merge_item(e,t):this._predictions.push(t)}},{key:"_sort",value:function(){this.predictions.sort(this.compare_predictions)}},{key:"compare_predictions",value:function(t,e){return e.probability-t.probability}},{key:"find_prediction",value:function(t){return n.find(this._predictions,function(e){return 0===o.compareNoCase(e.term,t)})}},{key:"merge_item",value:function(t,e){t.probability+=e.probability,t.count=Math.max(t.count,e.count)}},{key:"predictions",get:function(){return this._predictions}}]),t}();e.exports=s},{"../../../lib/rh":8,"./utils":33}],24:[function(t,e,i){var n=t("../../../lib/rh")._,o=t("./prediction_creator"),s=t("./prediction_list"),u=t("./consts"),l=t("./indices"),c=function(){function t(e){var i=e.loader,n=e.level,o=e.callback,s=e.previous,a=e.max_predictions,l=void 0===a?20:a;r(this,t),this.level=n,this.previous=s,this._max_predictions=l,this.predictions=[],this._callback=o,this._loader=i,this._source=u.PREDICTOR_SOURCE_ID.NGRAM_PREDICTOR}return a(t,[{key:"init",value:function(){}},{key:"clear",value:function(){this._word_model=void 0,this._prediction_array=void 0,this.parsed_input=void 0,this.predictions=[]}},{key:"getPredictions",value:function(t){this.parsed_input=t,this.predictions=[],void 0!==t&&t.words.length>=this.level?(this.word_index=t.words.length-this.level,this._word=t.words[this.word_index],this._loadInputModel(this._word,this._compute_word_predictions.bind(this))):this._onResultsComputed()}},{key:"_compute_word_predictions",value:function(t){this.predictions=[];var e=this.level,i=this._word,n=this._loader.getCount(i);this._word_model=this._loader.getWordModel(i,t),this._word_model&&(this._prediction_array=this._get_prediction_array(),this._compute_prediction_from_model(i,e,n)),this._onResultsComputed()}},{key:"_onResultsComputed",value:function(){this._callback&&this._callback(new s(this.predictions,this.parsed_input),this._loader)}},{key:"_compute_prediction_from_model",value:function(t,e,i){if(void 0!==this._prediction_array)if(this._is_my_level(e))this._compute_next_words(i);else{e--;var n=this._get_word_index(e),r=this.parsed_input.words[n],o=this._loader.getHashKey(r),s=this._get_next_model(this._prediction_array,o);s&&(i=s[l.MODEL.COUNT],this._prediction_array=s[l.MODEL.NEXT_MODEL],this._compute_prediction_from_model(r,e,i))}}},{key:"_get_next_model",value:function(t,e){if(e){var i=n.find(t,function(t){return t.length>1&&t[l.MODEL.WORD_HASH]===e});return i&&i.length>l.MODEL.NEXT_MODEL&&Array.isArray(i)?i:void 0}}},{key:"_get_word_index",value:function(t){return this.parsed_input.words.length-t}},{key:"_is_my_level",value:function(t){return 1===t}},{key:"_continueFn",value:function(){return!0}},{key:"_compute_next_words",value:function(t){var e=this._prediction_array;if(e&&e.length>0)for(var i=0;this.predictions.length<this.max_predictions&&i<e.length&&e[i].length>1;i++)if(this._matches_partially(e[i])){var n=this._create_predictions(e[i],t);this._compute_next_multi_words(n)}}},{key:"_compute_next_multi_words",value:function(t){var e=this;n.each(t,function(t){void 0!==t&&e.predictions.push(t)})}},{key:"_get_word_hash",value:function(t){return this._loader.getMapHash(t[l.MODEL.WORD_HASH])}},{key:"_matches_partially",value:function(t){if(this.parsed_input.isWholeWord)return!0;var e=this._loader.getMapHash(t[l.MODEL.WORD_HASH]);if(!e)return!1;var i=e[l.MAP.WORD];return this.parsed_input.comparePartial(i)}},{key:"_create_predictions",value:function(t,e){return new o({loader:this._loader,model_item:t,total_count:e,parsed_input:this.parsed_input,continueFn:this._continueFn}).getMultiPredictions(void 0,void 0,void 0,this._source)}},{key:"_get_prediction_array",value:function(){return this.parsed_input.isPrevious&&this._word_model.length>1?this._word_model[1]:this._word_model[0]}},{key:"_loadInputModel",value:function(t,e){var i=this._findFileIndex(t);this._loader.loadModel(i,e)}},{key:"_findFileIndex",value:function(t){return this._loader.getModelFileNo(t)}},{key:"max_predictions",set:function(t){this.max_predictions=t},get:function(){return this._max_predictions}}]),t}();e.exports=c},{"../../../lib/rh":8,"./consts":14,"./indices":20,"./prediction_creator":27,"./prediction_list":28}],25:[function(t,e,i){var n=t("../../../lib/rh").consts,o=function(){function t(e){r(this,t),this._path=e||"",this.initPath()}return a(t,[{key:"initPath",value:function(){"."===this._path&&(this._path=""),"."===this._path[0]&&"/"===this._path[1]&&(this._path=this._path.slice(2))}},{key:"_getModelFileName",value:function(t){return n("SEARCH_MODEL_ADDR")+t.toString()+".js"}},{key:"getModelFilePath",value:function(t){var e=this._getModelFileName(t);return this._getRelativePath(e)}},{key:"_getRelativePath",value:function(t){return""===this._path?t:this._path+"/"+t}},{key:"_getPathKey",value:function(){return""===this._path?"":"_"+this._path+"_"}},{key:"getModelKey",value:function(t){return n("SEARCH_MODEL_KEY")+this._getPathKey()+t.toString()}},{key:"_getMapFileName",value:function(){return n("SEARCH_MAP_ADDR")}},{key:"getMapFilePath",value:function(){var t=this._getMapFileName();return this._getRelativePath(t)}},{key:"getIndexFilePath",value:function(){var t=n("SEARCH_INDEX_FILE");return this._getRelativePath(t)}}]),t}();e.exports=o},{"../../../lib/rh":8}],26:[function(t,e,i){e.exports=function t(e,i,n,o){r(this,t),this.probability=i,this.term=e,this.count=n,this.source=o}},{}],27:[function(t,e,i){var n=t("./prediction"),o=t("./utils"),s=t("./indices"),u=t("./input_parser"),l=t("./consts"),c=function(){function t(e){var i=e.loader,n=e.model_item,o=e.total_count,s=e.parsed_input,a=e.continueFn;r(this,t),this._model_item=n,this.parsed_input=s||new u(""),this._init(),this._total_count=o,this._continueFn=a||this._isStopWord,this._nextModelFn=this._nextModel,this._predictions=[],this._multi_prediction=!1,this._loader=i}return a(t,[{key:"_init",value:function(){this.term="",this.probability=1,this._first_word=!0,this.isFirstLevel=!1,this._level=0}},{key:"getPrediction",value:function(t,e,i,n){return this.word_hash=t,this.isFirstLevel=e,this.previous=i,this.source=n,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,t),this._createPrediction()}},{key:"getMultiPredictions",value:function(t,e,i,n){return this._multi_prediction=!0,this.word_hash=t,this.isFirstLevel=e,this.previous=i,this.source=n,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,t),this._predictions}},{key:"equalRemaingWord",value:function(t){var e=this._getword(t,this.word_hash);return!(!e||!this.parsed_input.equalRemaingWord(e))}},{key:"_appendPreviousPredictions",value:function(t){var e=this._getPreviousItem(t);if(e){this._getPreviousProbability(e)>l.minPreviousThreshold&&this._appendPreviousTerm(e)}}},{key:"_getPreviousItem",value:function(t){var e=o.getFirstLevelNextModel(t,!0);if(e){return o.getSafeElement(e,0)}}},{key:"_appendPreviousTerm",value:function(t){var e=this._getword(t);if(e){if(this.parsed_input.equalLastWord(e))return;this.term=this.parsed_input.replaceLastWord(e),this._first_word=!1}}},{key:"_createPrediction",value:function(){if(""!==this.term){var t=this.parsed_input.completeSuggestion(this.term);return new n(t,this.probability,1,this.source)}}},{key:"_appendPrediction",value:function(t){if(this.probability=this.probability*this._calculateProbability(t),this._update_term(t),this._shouldCreatePrediction(t)&&this._predictions.push(this._createPrediction()),this._continueFn(t)){var e=this._nextModel(t);this._total_count=this._getCount(t),this._level++,this._first_word=!1,this.isFirstLevel=!1,this.word_hash=void 0,e&&this._appendPrediction(e)}}},{key:"_getPreviousProbability",value:function(t){var e=this._getCount(this.model_item);return o.getCountfromModel(t)/e}},{key:"_update_term",value:function(t){this.parsed_input.isPrevious?this.term=this._nextTerm(t)+this.term:this.term=this.term+this._nextTerm(t)}},{key:"_getword",value:function(t,e){return e=e||this._get_word_hash(t),o.getSafeElement(e,s.MAP.WORD)}},{key:"_get_word_hash",value:function(t){return this._loader.getMapHash(t[s.MODEL.WORD_HASH])}},{key:"_nextModel",value:function(t){var e=void 0;if((e=this.isFirstLevel?o.getFirstLevelNextModel(t,this.previous):o.getNextModel(t))&&e.length>0)return o.getFirstPrediction(e)}},{key:"_nextTerm",value:function(t){var e=this._getword(t,this.word_hash);return e?this._first_word?this.parsed_input.completeWord(e):" "+e:""}},{key:"_calculateProbability",value:function(t){return this._getCount(t)/this._total_count}},{key:"_getCount",value:function(t){return this.word_hash?o.getCountfromWordHash(this.word_hash):o.getCountfromModel(t)}},{key:"_shouldCreatePrediction",value:function(t){return this._multi_prediction&&!this._isStopWord(t)&&!this.equalRemaingWord(t)}},{key:"_isStopWord",value:function(t){var e=this._getword(t,this.word_hash);return!!e&&this._loader.isStopWord(e)}}]),t}();e.exports=c},{"./consts":14,"./indices":20,"./input_parser":21,"./prediction":26,"./utils":33}],28:[function(t,e,i){var n=function(){function t(e,i){r(this,t),this.parsed_input=i,this._list=e||[]}return a(t,[{key:"isForInput",value:function(t,e){return this.parsed_input.isPrevious?void 0!==e&&this.parsed_input.original_text===e.original_text:this.parsed_input.original_text===t.original_text}},{key:"isEmpty",value:function(){return 0===this._list.length}},{key:"predictions",get:function(){return this._list}}]),t}();e.exports=n},{}],29:[function(t,e,i){var n=t("./loader"),o=t("../../../lib/rh"),s=o._,u=t("./history_predictor"),l=t("./ngram_predictor"),c=t("./general_predictor"),h=t("./corrector"),d=t("./consts"),_=function(){function t(e,i){r(this,t),this._history_reader=e,this._processResultFn=i}return a(t,[{key:"_getProjectPaths",value:function(){return o.model.get(o.consts("KEY_PROJECT_LIST"))}},{key:"_createLoaders",value:function(){var t=[],e=this._getProjectPaths();return s.each(e,function(e){t.push(new n(e))}),t}},{key:"createPredictors",value:function(t,e,i){var n=this;this._addFn=t,this._prevaddFn=e,this._addCorrectorFn=i;var r=new u(this._history_reader,this._processResultFn);this._addFn(r);var o=this._createLoaders();s.each(o,function(t){t.init(n.addPredictors.bind(n))})}},{key:"addPredictors",value:function(t){for(var e=1;e<=t.nGram;e++){var i=new l({loader:t,level:e,callback:this._processResultFn});i.init(),this._addFn(i)}for(var n=1;n<=d.previousnGram;n++){var r=new l({loader:t,level:n,callback:this._processResultFn,previous:!0});r.init(),this._prevaddFn(r)}var o=new c(this._processResultFn,t);this._addFn(o);var s=new h(t,this._processResultFn);this._addCorrectorFn(s)}}]),t}();e.exports=_},{"../../../lib/rh":8,"./consts":14,"./corrector":15,"./general_predictor":17,"./history_predictor":18,"./loader":22,"./ngram_predictor":24}],30:[function(t,e,i){var n=t("../../../lib/rh"),o=n._,s=n.consts,u=t("./history_reader"),l=t("./input_parser"),c=t("./merger"),h=t("./topic_counter"),d=t("./utils"),_=t("./consts"),p=t("./counting_seamaphore"),f=t("./predictors_creator"),v=5,g=function(){function t(e){var i=this;r(this,t),this.widget=e,this._predictors=[],this._correctors=[],this._previous_predictors=[],this.initHandleKeyHash(),this.max_predictions=v,this.predicton_merger=new c([]),e.model.subscribe(s("KEY_PROJECT_LIST"),function(){i.init()})}return a(t,[{key:"init",value:function(){var t=n.storage.fetch(s("PREV_SEARCH_KEY"));u.initHistory(t),this.create_predictors(),this.widget.model.csubscribe("EVT_CLOSE_SEARCH_SUGGESTION",this.closeSuggestions.bind(this))}},{key:"create_predictors",value:function(){this._predictors=[];new f(u,this.processResult.bind(this)).createPredictors(this.addPredictor.bind(this),this.addPrevPredictor.bind(this),this.addCorrector.bind(this))}},{key:"addPredictor",value:function(t){this._predictors.push(t)}},{key:"addPrevPredictor",value:function(t){this._previous_predictors.push(t)}},{key:"addCorrector",value:function(t){this._correctors.push(t)}},{key:"showSuggestions",value:function(t){this._initSuggestions(t),this._calculateSugguestions()}},{key:"_initSuggestions",value:function(t){this._initResult(),this._initInputs(t),this._resutSeamaphore=new p(this.onResultComplete.bind(this))}},{key:"_initInputs",value:function(t){this.parsed_input=new l(t.text,!1,t.selStart,!1),d.isPrevious(t)&&(this._previous_input=new l(t.text,!1,t.selStart,!0))}},{key:"_calculateSugguestions",value:function(){var t=this;this._resutSeamaphore.wait(this._predictorCount()),o.each(this._predictors,function(e){e.getPredictions(t.parsed_input)}),this._previous_input&&o.each(this._previous_predictors,function(e){e.getPredictions(t._previous_input)})}},{key:"_clearPredictors",value:function(){o.each(this._predictors,function(t){t.clear()}),o.each(this._previous_predictors,function(t){t.clear()}),o.each(this._correctors,function(t){t.clear()})}},{key:"_predictorCount",value:function(){var t=this._predictors.length;return this._previous_input&&(t+=this._previous_predictors.length),t}},{key:"_initResult",value:function(){this.predicton_merger&&this.predicton_merger.clear(),this.widget.publish("selected",void 0),this._previous_input=void 0,this._computing_correction=!1}},{key:"_clearResult",value:function(){this._resetMovement(),this._previous_input=void 0,this.parsed_input=void 0,this._resutSeamaphore=void 0,this._clearPredictors()}},{key:"isSuggestionsOpen",value:function(){var t=this.widget.get(s("SEARCH_RESULTS_KEY"));return t&&t.length>0}},{key:"processResult",value:function(t,e){if(t.isForInput(this.parsed_input,this._previous_input)){if(!t.isEmpty()){this.predicton_merger.merge(t.predictions);var i=new h(e);this.predictions=i.computeCounts(this.predictions,this.parsed_input)}this._resutSeamaphore.signal()}}},{key:"onResultComplete",value:function(){this.needCorrection()?this.doCorrection():(this.predictions.splice(this.max_predictions),this.widget.publish(s("SEARCH_RESULTS_KEY"),this.predictions),this._clearResult())}},{key:"needCorrection",value:function(){return!this._computing_correction&&0===this.predictions.length&&""!==this.parsed_input.trimmedText}},{key:"doCorrection",value:function(){var t=this;this._computing_correction=!0,this._resutSeamaphore=new p(this.onResultComplete.bind(this)),this._resutSeamaphore.wait(this._correctors.length),o.each(this._correctors,function(e){e.getCorrections(t.parsed_input)})}},{key:"canDelete",value:function(t){var e=this.predictions[t];return void 0!==e&&e.source===_.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR}},{key:"handleDelete",value:function(t){var e=this.predictions[t];this._deleteFromHistory(e.term),this._removePrediction(t),this.widget.publish("history_deleted",!0)}},{key:"_removePrediction",value:function(t){this.predictions.splice(t,1),this.widget.publish(s("SEARCH_RESULTS_KEY"),this.predictions)}},{key:"handleClick",value:function(t){if(!this.widget.get("history_deleted")){var e=this.predictions[t];if(void 0!==e){var i=e.term;this._addToHistory(i),this.widget.publish(s("KEY_SEARCH_TERM"),i),this.widget.publish(n.consts("EVT_SEARCH_TERM"),!0)}}}},{key:"handleFocusOut",value:function(t,e){this.widget.get("history_deleted")?(this.widget.publish("history_deleted",!1),this.widget.publish(e,!0)):this.widget.publish(t,!1)}},{key:"getFirstSuggestionIndex",value:function(t,e){return e?0:t-1}},{key:"getNextSuggestionIndex",value:function(t,e,i){return t=void 0===t?0:t,t=(t+(i?1:e-1))%e}},{key:"handleArrowKey",value:function(t){var e=this.widget.get("selected"),i=40===t.keyCode,n=this.getPredictionsLength();if(n>0){e=void 0===e?this.getFirstSuggestionIndex(n,i):this.getNextSuggestionIndex(e,n,i),this.widget.publish("selected",e);var r=this.getNewInputText(this.results[e]);this.widget.publish(s("KEY_SEARCH_TERM"),r)}}},{key:"getNewInputText",value:function(t){return t.term}},{key:"getPredictionsLength",value:function(){var t=void 0;return this.results=this.widget.get(s("SEARCH_RESULTS_KEY")),this.results&&(t=this.results.length),t}},{key:"closeSuggestions",value:function(){this._clearResult(),this.widget.publish("selected",void 0),this.original_parsed_input=void 0,this.widget.publish(s("SEARCH_RESULTS_KEY"),[])}},{key:"_deleteFromHistory",value:function(t){u.delete(t),this._saveHistory()}},{key:"_addToHistory",value:function(t){t&&""!==t&&(u.add({text:t.trim(),count:10}),this._saveHistory())}},{key:"_saveHistory",value:function(){n.storage.persist(s("PREV_SEARCH_KEY"),u.getHistory())}},{key:"handleShowSuggestion",value:function(t){""===t.text||!1===d.shouldShowSuggestion(t)?this.closeSuggestions():this.showSuggestions(t)}},{key:"handleReturn",value:function(t){""!==t.text&&(this._addToHistory(t.text),this.closeSuggestions())}},{key:"_isMovementKey",value:function(t){return[38,39,40].indexOf(t)>=0}},{key:"_resetMovement",value:function(){this.original_parsed_input=void 0,this.widget.publish("selected",void 0)}},{key:"_isHandlingCursorMove",value:function(){return void 0!==this.widget.get("selected")}},{key:"initHandleKeyHash",value:function(){this.handle_key_hash={up:this.handleArrowKey.bind(this),down:this.handleArrowKey.bind(this),backspace:this.handleBackSpace.bind(this),return:this.handleReturn.bind(this),default:this.handleShowSuggestion.bind(this),escape:this.handleEscape.bind(this),right:this.handleRight.bind(this)}}},{key:"handleRight",value:function(t){return this._isHandlingCursorMove()?(d.shouldAppendSpace(t)&&(t.text+=" ",t.selStart+=1,this.widget.publish(s("KEY_SEARCH_TERM"),t.text)),this._resetMovement(),this.handleShowSuggestion(t),!1):(this._resetMovement(),this.handleShowSuggestion(t))}},{key:"handleBackSpace",value:function(t){return this.handleShowSuggestion(t)}},{key:"handleEscape",value:function(){this.closeSuggestions()}},{key:"handleKey",value:function(t){var e=t.keyCode,i={keyCode:e,selStart:t.target.selectionStart,text:t.target.value};this._isMovementKey(e)||this._resetMovement();var n=o.getKeyIndex(e);if(void 0===n)return!0;var r=this.handle_key_hash[n];return r?r(i):void 0}},{key:"predictions",get:function(){return this.predicton_merger.predictions},set:function(t){this.predicton_merger=new c(t)}}]),t}();n.controller("SearchController",g)},{"../../../lib/rh":8,"./consts":14,"./counting_seamaphore":16,"./history_reader":19,"./input_parser":21,"./merger":23,"./predictors_creator":29,"./topic_counter":32,"./utils":33}],31:[function(t,e,i){var n=function(){function t(e){r(this,t),this._set=e||[],this._initialised=!1}return a(t,[{key:"intersect",value:function(t){Array.isArray(t)||(t=t.set);for(var e=[],i=0,n=0,r=0;n<this._set.length&&r<t.length;)this._set[n]<t[r]?n++:this._set[n]>t[r]?r++:(e[i++]=this._set[n],n++,r++);this._set=e}},{key:"intersectOrSet",value:function(t){this._initialised?this.intersect(t):(Array.isArray(t)||(t=t.set),this.set=t,this._initialised=!0)}},{key:"intersectCount",value:function(t){Array.isArray(t)||(t=t.set);for(var e=0,i=0,n=0;i<this._set.length&&n<t.length;)this._set[i]<t[n]?i++:this._set[i]>t[n]?n++:(e++,i++,n++);return e}},{key:"set",set:function(t){this._set=t||[]},get:function(){return this._set}},{key:"length",get:function(){return this._set.length}}]),t}();e.exports=n},{}],32:[function(t,e,i){var n=t("./sorted_set"),o=t("./input_parser"),s=t("./prediction"),u=t("../../../lib/rh")._,l=t("./indices"),c=function(){function t(e){r(this,t),this.newPredictions=[],this.predictionSet=new n,this.inputSet=new n,this._loader=e}return a(t,[{key:"computeCounts",value:function(t,e){var i=this;return this.newPrediction=[],this.parsed_input=e,u.each(t,function(t){i.addUpdatedPrediction(t)}),this.newPredictions}},{key:"addUpdatedPrediction",value:function(t){var e=1;if(void 0!==this._loader&&(this.createPredictionSet(t),e=this.computeTopicCount()),e>0){var i=new s(t.term,t.probability,e,t.source);this.newPredictions.push(i)}}},{key:"computeTopicCount",value:function(){return this.predictionSet.set.length}},{key:"createPredictionSet",value:function(t){var e=this;this.predictionSet=new n;var i=new o(t.term,!0);u.each(i.words,function(t,i){e._addWordToSet(t,e.predictionSet,i)})}},{key:"initInput",value:function(t){var e=this;this.inputSet=new n,u.each(t.words,function(t){e._addWordToSet(t,e.inputSet)})}},{key:"_addWordToSet",value:function(t,e){if(!this._loader.isStopWord(t)){var i=this._loader._getHashForWord(t);i&&i.length>l.MAP.TOPICS&&e.intersectOrSet(i[l.MAP.TOPICS])}}}]),t}();e.exports=c},{"../../../lib/rh":8,"./indices":20,"./input_parser":21,"./prediction":26,"./sorted_set":31}],33:[function(e,i,n){(function(t){var n=e("./indices"),r={getNextModel:function(t){if(t&&Array.isArray(t)&&t.length>n.MODEL.NEXT_MODEL)return t[n.MODEL.NEXT_MODEL]},getFirstLevelNextModel:function(t,e){if(t&&Array.isArray(t)){if(!e&&t.length>n.FIRST_PREDICTION.NEXT)return t[n.FIRST_PREDICTION.NEXT];if(e&&t.length>n.FIRST_PREDICTION.PREVIOUS)return t[n.FIRST_PREDICTION.PREVIOUS]}},getFirstPrediction:function(t){if(t&&Array.isArray(t)&&t.length>0&&Array.isArray(t[0]))return t[0]},compareNoCase:function(e,i){return void 0!==t.compare?t.compare(e,i):e===i?0:-1},hammingDistance:function(t,e){for(var i=Math.min(t.length,e.length),n=0,r=0;r<i;r++)t[r]!==e[r]&&n++;return t.length>i&&(n+=t.length-i),n},isPrevious:function(t){return t.selStart<t.text.length},shouldShowSuggestion:function(t){var e=t.text,i=t.selStart;return 0===i||i===e.length||e.length>0&&(" "===e[i]||" "===e[i-1])},shouldAppendSpace:function(t){var e=t.text,i=t.selStart;return e.length>0&&i===e.length&&" "!==e[e.length-1]},getSafeElement:function(t,e){if(t&&Array.isArray(t)&&t.length>e)return t[e]},getCountfromModel:function(t){return Array.isArray(t)&&t.length>n.MODEL.COUNT?t[n.MODEL.COUNT]:0},getCountfromWordHash:function(t){return Array.isArray(t)&&t.length>n.MAP.COUNT?t[n.MAP.COUNT]:0}};i.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0!==t?t:{})},{"./indices":20}],34:[function(t,e,i){var n=t("../../lib/rh"),o=n._,s=n.consts,u=function(){function t(e){r(this,t),this.widget=e}return a(t,[{key:"getLink",value:function(t){var e=t,i=this.widget.get(s("KEY_SEARCH_RESULT_PARAMS")),n=this.widget.get(s("KEY_SEARCH_TERM")),r="";if(n&&""!==n){var a={};a[s("HASH_KEY_RH_SEARCH")]=n,r=o.mapToEncodedString(a)}return void 0!==i&&""!==i?e=e+i+"&"+r:""!==r&&(e=e+"?"+r),e}}]),t}();n.controller("SearchResultController",u)},{"../../lib/rh":8}],35:[function(t,e,i){var n=t("../../lib/rh"),o=n._,s=n.consts,u=function(){function t(e){r(this,t),this.widget=e}return a(t,[{key:"select",value:function(t,e){this.widget.publish(s("KEY_TOC_SELECT_ITEM"),{id:t,url:e})}},{key:"getLink",value:function(t){if(t){var e=this.widget.get(s("KEY_TOC_BREADCRUMBS"))[t];if(e&&e.hasUrl)return e.url}}},{key:"goToHome",value:function(t){if(t){var e=this.widget.get(s("KEY_TOC_BREADCRUMBS"))[t];e&&!e.hasUrl&&o.goToHome({rhtocid:e.id})}}}]),t}();n.controller("TocBreadcrumbsController",u)},{"../../lib/rh":8}],36:[function(t,e,i){var n=t("../../../lib/rh"),o=n.$,s="change",u=function(){function t(e,i){var o=this;r(this,t),this.widget=e,this.node=this.widget.node,this.tab=0,n.model.subscribeOnce(n.consts(i.key),function(){o.widget.publish(s,!0)}),n.model.subscribe(n.consts("KEY_SCREEN"),function(){o.goto(o.tab,0)}),n.model.subscribe(i.key+"gototab",function(t){o.goto(o.pagecount(),t.tab)})}return a(t,[{key:"goto",value:function(t,e){var i=this;this.tab=e,this.carouselnode=o.find(this.node,".carousel")[0],this.animateLeft(t),n._.delay(function(){i.widget.publish(s,!0)},1e3)}},{key:"hasNext",value:function(){this.carouselnode=o.find(this.node,".carousel")[0];var t=o.find(o.find(this.node,".carousel")[0],".carousel-item:not(.hide):not(.rh-hide)");return(t=t&&t.length>0?t[t.length-1]:null).offsetLeft+this.carouselnode.offsetLeft>this.carouselnode.offsetWidth}},{key:"animateLeft",value:function(){var t="calc(-"+14*this.tab+"px - "+100*this.tab+"%)";o.css(this.carouselnode,"left",t)}},{key:"next",value:function(){this.goto(this.tab,this.tab+1)}},{key:"pagecount",value:function(){return this.tab}},{key:"previous",value:function(){this.goto(this.tab,this.tab-1)}},{key:"ensureVisible",value:function(){}}]),t}();n.controller("Carousel",u)},{"../../../lib/rh":8}],37:[function(t,e,i){var n=t("../../lib/rh").$;e.exports={nodeType:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},removeChild:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parentNode(t);return e&&e.removeChild&&e.removeChild(t)},appendChild:function(t,e){return t&&t.appendChild&&t.appendChild(e)},parentNode:function(t){return t&&t.parentNode},childNodes:function(t){return t&&t.childNodes||[]},toHtmlNode:function(t){return this.childNodes(n.createElement("div",t))},outerHTML:function(t){return t&&t.outerHTML||""},insertAfter:function(t,e){return t.parentNode.insertBefore(e,t.nextSibling)},value:function(t){return t&&t.nodeValue},name:function(t){return t&&t.nodeName},type:function(t){return t&&t.nodeType},isElementNode:function(t){return this.type(t)===this.nodeType.ELEMENT_NODE},isTextNode:function(t){return this.type(t)===this.nodeType.TEXT_NODE}}},{"../../lib/rh":8}]},{},[9])}(window,document,window.location);